%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% This script uses the nomenclature, formulations and solutions from:
%   M. Avillez and D. Arnas, "Osculating and Mean Asynchronous Relative Motion Approximations 
%   Under J2 and Atmospheric Drag", TODO
%
% Summary:
%   Given the initial mean relative state and the initial mean state of the chief, computes the
%     mean relative state at the selected argument of latitude.
%   Implements the solution from section V.C of the paper.
%
% Inputs:
%   tt: argument of latitude at which to compute the mean relative state
%   mu: gravitational parameter
%   j2: J2 coefficient of the gravity model
%   R: Radius of the central planet
%   tti: Initial argument of latitude
%   meanRelativeStateInitial: Mean initial relative state -> see Note 1
%   meanStateInitialC: Mean initial state of the chief -> see Note 1
%   kD: Ballistic parameter of the deputy (D)
%   rhoD: Atmospheric density acting on the deputy (D)
%   kC: Ballistic parameter of the chief (C)
%   rhoC: Atmospheric density acting on the chief (C)
%   expansionOrder: Order of the expansion to use (2 or 3)
%
% Outputs:
%   relativeState: Mean relative state at the selected argument of latitude. -> see Note 1
%
% Note 1:
%   Mean relative states: [dbbM; dxM; dyM; dpM; dooM; dtM]
%   Mean absolute states: [bbM; xM; yM; pM; ooM; tM]
%
% Authors: Miguel Avillez and David Arnas
% Created: August 2025
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
function meanRelativeState = meanRelativeState(tt, mu, j2, R, tti, meanRelativeStateInitial, meanStateInitialC, ...
  kD, rhoD, kC, rhoC, expansionOrder)

  if expansionOrder == 2
    meanRelativeState = meanRelativeStateOrder2(tt, mu, j2, R, tti, meanRelativeStateInitial, meanStateInitialC, kD, rhoD, kC, rhoC);
  elseif expansionOrder == 3
    meanRelativeState = meanRelativeStateOrder3(tt, mu, j2, R, tti, meanRelativeStateInitial, meanStateInitialC, kD, rhoD, kC, rhoC);
  else
    error("Invalid expansion order")
  end

end

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Function: meanRelativeStateOrder2
%
% Summary:
%   Given the initial relative state and the initial state of the chief, computes the
%   mean relative state at the selected argument of latitude using the 2nd order solution.
%
% Inputs:
%   tt: argument of latitude at which to compute the mean relative state
%   mu: gravitational parameter
%   j2: J2 coefficient of the gravity model
%   R: Radius of the central planet
%   tti: Initial argument of latitude
%   meanRelativeStateInitial: Mean initial relative state -> see Note 1
%   meanStateInitialC: Mean initial state of the chief -> see Note 1
%   kD: Ballistic parameter of the deputy (D)
%   rhoD: Atmospheric density acting on the deputy (D)
%   kC: Ballistic parameter of the chief (C)
%   rhoC: Atmospheric density acting on the chief (C)
%
% Outputs:
%   meanRelativeState: Mean relative state at the selected argument of latitude. -> see Note 1
%
% Note 1:
%   Mean relative states: [dbbM; dxM; dyM; dpM; dooM; dtM]
%   Mean absolute states: [bbM; xM; yM; pM; ooM; tM]
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
function meanRelativeState = meanRelativeStateOrder2(tt, mu, j2, R, tti, meanRelativeStateInitial, ...
  meanStateInitialC, kD, rhoD, kC, rhoC)

  % Extract individual elements of the chief's mean initial state
  bbMi = meanStateInitialC(1);
  xMi = meanStateInitialC(2);
  yMi = meanStateInitialC(3);
  pMi = meanStateInitialC(4);

  % Extract individual elements of the initial mean relative state
  dbbMi = meanRelativeStateInitial(1);
  dxMi = meanRelativeStateInitial(2);
  dyMi = meanRelativeStateInitial(3);
  dpMi = meanRelativeStateInitial(4);
  dooMi = meanRelativeStateInitial(5);
  dtMi = meanRelativeStateInitial(6);

  % Compute the mean relative state at tt
  dbb = dbbMi+(-1/8).*bbMi.^(-2).*R.*(tt+(-1).*tti).*(4.*bbMi.*kC.*rhoC+( ...
    -4).*bbMi.*kD.*rhoD+4.*dbbMi.*kD.*rhoD+3.*bbMi.^5.*j2.*((-1)+ ...
    bbMi.^2.*pMi.^2).*((-1).*kC.*rhoC+kD.*rhoD).*cos(2.*tti));
  dx = dxMi+(3/4).*bbMi.^2.*(tt+(-1).*tti).*(bbMi.*j2.*(4.*dbbMi.*yMi+ ...
    bbMi.*(dyMi+(-5).*bbMi.^2.*dyMi.*pMi.^2+(-10).*bbMi.*pMi.*(bbMi.* ...
    dpMi+3.*dbbMi.*pMi).*yMi))+(-1).*((-1)+5.*bbMi.^2.*pMi.^2).*R.*(( ...
    -1).*kC.*rhoC+kD.*rhoD).*cos(tti));
  dy = dyMi+(3/4).*bbMi.^2.*(tt+(-1).*tti).*(bbMi.*j2.*((-1).*bbMi.*dxMi+ ...
    (-4).*dbbMi.*xMi+30.*bbMi.^2.*dbbMi.*pMi.^2.*xMi+5.*bbMi.^3.*pMi.* ...
    (dxMi.*pMi+2.*dpMi.*xMi))+(-1).*((-1)+5.*bbMi.^2.*pMi.^2).*R.*(( ...
    -1).*kC.*rhoC+kD.*rhoD).*sin(tti));
  dp = dpMi+(1/4).*bbMi.^(-3).*R.*(tt+(-1).*tti).*(2.*bbMi.*kC.*pMi.* ...
    rhoC+4.*dbbMi.*kD.*pMi.*rhoD+(-2).*bbMi.*kD.*(dpMi+pMi).*rhoD+3.* ...
    bbMi.^5.*j2.*pMi.*((-1)+bbMi.^2.*pMi.^2).*((-1).*kC.*rhoC+kD.* ...
    rhoD).*cos(2.*tti));
  doo = dooMi+(3/8).*bbMi.^3.*j2.*((-2).*bbMi.*dpMi.*(2.*bbMi+10.*dbbMi+ ...
    bbMi.^5.*j2)+(-2).*dbbMi.*(10.*bbMi+20.*dbbMi+9.*bbMi.^5.*j2).* ...
    pMi+15.*bbMi.^8.*dpMi.*j2.*pMi.^2+55.*bbMi.^7.*dbbMi.*j2.*pMi.^3) ...
    .*(tt+(-1).*tti);
  dt = (1/128).*bbMi.^(-7).*mu.^(-1/2).*(128.*bbMi.^7.*dtMi.*mu.^(1/2)+ ...
    135.*bbMi.^10.*j2.^2.*kC.*pi.^2.*((-1)+bbMi.^2.*pMi.^2).^2.*R.^( ...
    5/2).*rhoC+160.*bbMi.*dbbMi.*kD.*pi.^2.*R.^(5/2).*rhoD+(-480).* ...
    dbbMi.^2.*kD.*pi.^2.*R.^(5/2).*rhoD+(-135).*bbMi.^10.*j2.^2.*kD.* ...
    pi.^2.*R.^(5/2).*rhoD+270.*bbMi.^12.*j2.^2.*kD.*pi.^2.*pMi.^2.* ...
    R.^(5/2).*rhoD+(-135).*bbMi.^14.*j2.^2.*kD.*pi.^2.*pMi.^4.*R.^( ...
    5/2).*rhoD+120.*bbMi.^6.*j2.^2.*pi.^2.*((-1)+bbMi.^2.*pMi.^2).* ...
    R.^(5/2).*((-1).*kC.*rhoC+kD.*rhoD).*xMi.*cos(tti)+192.*bbMi.^6.* ...
    j2.*R.^(3/2).*cos(tt).*(bbMi.*j2.*((-1).*bbMi.*dyMi+(-1).*dbbMi.* ...
    yMi+15.*bbMi.^2.*dbbMi.*pMi.^2.*yMi+5.*bbMi.^3.*pMi.*(dyMi.*pMi+ ...
    2.*dpMi.*yMi))+((-1)+5.*bbMi.^2.*pMi.^2).*R.*((-1).*kC.*rhoC+kD.* ...
    rhoD).*cos(tti))+2.*bbMi.^5.*j2.*R.^(3/2).*(15.*pi.^2.*R.*((-1).* ...
    bbMi.*kC.*((-1)+bbMi.^2.*pMi.^2).*(4+(-3).*bbMi.^4.*j2+3.* ...
    bbMi.^6.*j2.*pMi.^2).*rhoC+kD.*((-4).*bbMi+4.*dbbMi+3.*bbMi.^5.* ...
    j2+8.*bbMi.^3.*dpMi.*pMi+2.*bbMi.^2.*(2.*bbMi+2.*dbbMi+(-3).* ...
    bbMi.^5.*j2).*pMi.^2+3.*bbMi.^9.*j2.*pMi.^4).*rhoD).*cos(2.*tti)+ ...
    96.*bbMi.*sin(tt).*(bbMi.*j2.*(dbbMi.*xMi+bbMi.*(dxMi+(-5).* ...
    bbMi.^2.*dxMi.*pMi.^2+(-5).*bbMi.*pMi.*(2.*bbMi.*dpMi+3.*dbbMi.* ...
    pMi).*xMi))+((-1)+5.*bbMi.^2.*pMi.^2).*R.*((-1).*kC.*rhoC+kD.* ...
    rhoD).*sin(tti))+5.*bbMi.*j2.*pi.^2.*((-1)+bbMi.^2.*pMi.^2).*R.*(( ...
    -1).*kC.*rhoC+kD.*rhoD).*(4.*xMi.*cos(3.*tti)+3.*bbMi.^4.*(2+ ...
    bbMi.^2.*pMi.^2).*cos(4.*tti)+(-16).*yMi.*sin(tti).^3))+(-3).*R.^( ...
    5/2).*(tt+(-1).*tti).^2.*((-1).*bbMi.^2.*kC.*(32+135.*bbMi.^8.* ...
    j2.^2.*((-1)+bbMi.^2.*pMi.^2).^2).*rhoC+kD.*(32.*bbMi.^2+(-160).* ...
    bbMi.*dbbMi+480.*dbbMi.^2+135.*bbMi.^10.*j2.^2+(-270).*bbMi.^12.* ...
    j2.^2.*pMi.^2+135.*bbMi.^14.*j2.^2.*pMi.^4).*rhoD+(-10).*bbMi.^5.* ...
    j2.*(12.*bbMi.*j2.*((-1)+bbMi.^2.*pMi.^2).*((-1).*kC.*rhoC+kD.* ...
    rhoD).*xMi.*cos(tti)+3.*((-1).*bbMi.*kC.*((-1)+bbMi.^2.*pMi.^2).*( ...
    4+(-3).*bbMi.^4.*j2+3.*bbMi.^6.*j2.*pMi.^2).*rhoC+kD.*((-4).*bbMi+ ...
    4.*dbbMi+3.*bbMi.^5.*j2+8.*bbMi.^3.*dpMi.*pMi+2.*bbMi.^2.*(2.* ...
    bbMi+2.*dbbMi+(-3).*bbMi.^5.*j2).*pMi.^2+3.*bbMi.^9.*j2.*pMi.^4).* ...
    rhoD).*cos(2.*tti)+bbMi.*j2.*((-1)+bbMi.^2.*pMi.^2).*((-1).*kC.* ...
    rhoC+kD.*rhoD).*(4.*xMi.*cos(3.*tti)+3.*bbMi.^4.*(2+bbMi.^2.* ...
    pMi.^2).*cos(4.*tti)+(-16).*yMi.*sin(tti).^3)))+4.*bbMi.*R.^(3/2) ...
    .*(tt+(-1).*tti).*(192.*bbMi.*dbbMi.^2+(-320).*dbbMi.^3+48.* ...
    bbMi.^6.*dbbMi.*j2+405.*bbMi.^10.*dbbMi.*j2.^2+(-732).*bbMi.^13.* ...
    dpMi.*j2.^2.*pMi+(-576).*bbMi.^7.*dbbMi.^2.*j2.*pMi.^2+(-2562).* ...
    bbMi.^12.*dbbMi.*j2.^2.*pMi.^2+1572.*bbMi.^15.*dpMi.*j2.^2.* ...
    pMi.^3+3537.*bbMi.^14.*dbbMi.*j2.^2.*pMi.^4+(-576).*bbMi.^8.* ...
    dbbMi.*j2.*pMi.*(2.*dpMi+pMi)+(-192).*bbMi.^9.*dpMi.*j2.*(dpMi+2.* ...
    pMi)+96.*bbMi.^3.*j2.^2.*(dxMi.*xMi+dyMi.*yMi)+(-48).*bbMi.^2.* ...
    dbbMi.*(2+3.*j2.^2.*(xMi.^2+yMi.^2))+3.*bbMi.*j2.*(8.*(3.* ...
    bbMi.^5.*j2.*((-1).*bbMi.*dxMi+(-5).*dbbMi.*xMi+7.*bbMi.^2.* ...
    dbbMi.*pMi.^2.*xMi+bbMi.^3.*pMi.*(dxMi.*pMi+2.*dpMi.*xMi))+4.*R.*( ...
    (-1).*kC.*rhoC+kD.*rhoD).*yMi).*cos(tti)+6.*bbMi.^4.*(dbbMi.^2.*(( ...
    -40)+84.*bbMi.^2.*pMi.^2)+dbbMi.*(27.*bbMi.^5.*j2+56.*bbMi.^3.* ...
    dpMi.*pMi+(-66).*bbMi.^7.*j2.*pMi.^2+39.*bbMi.^9.*j2.*pMi.^4)+4.* ...
    bbMi.^4.*dpMi.*(dpMi+3.*bbMi.^4.*j2.*pMi.*((-1)+bbMi.^2.*pMi.^2))) ...
    .*cos(2.*tti)+8.*bbMi.^5.*j2.*((-1).*bbMi.*dxMi+(-5).*dbbMi.*xMi+ ...
    7.*bbMi.^2.*dbbMi.*pMi.^2.*xMi+bbMi.^3.*pMi.*(dxMi.*pMi+2.*dpMi.* ...
    xMi)).*cos(3.*tti)+3.*bbMi.^9.*j2.*(4.*bbMi.^3.*dpMi.*pMi.*((-8)+ ...
    11.*bbMi.^2.*pMi.^2)+dbbMi.*(45+(-176).*bbMi.^2.*pMi.^2+143.* ...
    bbMi.^4.*pMi.^4)).*cos(4.*tti)+(-8).*(4.*R.*((-1).*kC.*rhoC+kD.* ...
    rhoD).*xMi+3.*bbMi.^5.*j2.*((-1).*bbMi.*dyMi+(-5).*dbbMi.*yMi+7.* ...
    bbMi.^2.*dbbMi.*pMi.^2.*yMi+bbMi.^3.*pMi.*(dyMi.*pMi+2.*dpMi.*yMi) ...
    )).*sin(tti)+(-16).*bbMi.^4.*((-1)+bbMi.^2.*pMi.^2).*R.*((-1).* ...
    kC.*rhoC+kD.*rhoD).*sin(2.*tti)+8.*bbMi.^5.*j2.*((-1).*bbMi.*dyMi+ ...
    (-5).*dbbMi.*yMi+7.*bbMi.^2.*dbbMi.*pMi.^2.*yMi+bbMi.^3.*pMi.*( ...
    dyMi.*pMi+2.*dpMi.*yMi)).*sin(3.*tti))));

  % Concatenate the elements of the final relative state
  meanRelativeState = [dbb; dx; dy; dp; doo; dt];

end

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Function: meanRelativeStateOrder3
%
% Summary:
%   Given the initial relative state and the initial state of the chief, computes the
%   mean relative state at the selected argument of latitude using the 3rd order solution.
%
% Inputs:
%   tt: argument of latitude at which to compute the mean relative state
%   mu: gravitational parameter
%   j2: J2 coefficient of the gravity model
%   R: Radius of the central planet
%   tti: Initial argument of latitude
%   meanRelativeStateInitial: Mean initial relative state -> see Note 1
%   meanStateInitialC: Mean initial state of the chief -> see Note 1
%   kD: Ballistic parameter of the deputy (D)
%   rhoD: Atmospheric density acting on the deputy (D)
%   kC: Ballistic parameter of the chief (C)
%   rhoC: Atmospheric density acting on the chief (C)
%
% Outputs:
%   meanRelativeState: Mean relative state at the selected argument of latitude. -> see Note 1
%
% Note 1:
%   Mean relative states: [dbbM; dxM; dyM; dpM; dooM; dtM]
%   Mean absolute states: [bbM; xM; yM; pM; ooM; tM]
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
function meanRelativeState = meanRelativeStateOrder3(tt, mu, j2, R, tti, meanRelativeStateInitial, ...
  meanStateInitialC, kD, rhoD, kC, rhoC)

  % Extract individual elements of the chief's mean initial state
  bbMi = meanStateInitialC(1);
  xMi = meanStateInitialC(2);
  yMi = meanStateInitialC(3);
  pMi = meanStateInitialC(4);

  % Extract individual elements of the initial mean relative state
  dbbMi = meanRelativeStateInitial(1);
  dxMi = meanRelativeStateInitial(2);
  dyMi = meanRelativeStateInitial(3);
  dpMi = meanRelativeStateInitial(4);
  dooMi = meanRelativeStateInitial(5);
  dtMi = meanRelativeStateInitial(6);

  % Compute the mean relative state at tt
  dbb = (1/128).*j2.*(90.*bbMi.^7.*j2.*(3+(-8).*bbMi.^2.*pMi.^2+5.* ...
    bbMi.^4.*pMi.^4).*R.*((-1).*kC.*rhoC+kD.*rhoD).*cos(2.*tti).*sin( ...
    2.*tt)+8.*bbMi.^7.*j2.*(1+(-6).*bbMi.^2.*pMi.^2+5.*bbMi.^4.* ...
    pMi.^4).*R.*((-1).*kC.*rhoC+kD.*rhoD).*cos(tti).*(9.*sin(tt)+sin( ...
    3.*tt))+8.*j2.^(-1).*(16.*dbbMi+(-9).*bbMi.^8.*j2.^3.*(bbMi.*dxMi+ ...
    9.*dbbMi.*xMi+(-66).*bbMi.^2.*dbbMi.*pMi.^2.*xMi+65.*bbMi.^4.* ...
    dbbMi.*pMi.^4.*xMi+(-6).*bbMi.^3.*pMi.*(dxMi.*pMi+2.*dpMi.*xMi)+ ...
    5.*bbMi.^5.*pMi.^3.*(dxMi.*pMi+4.*dpMi.*xMi)).*cos(tt)+bbMi.^8.* ...
    j2.^3.*(bbMi.*dxMi+9.*dbbMi.*xMi+(-66).*bbMi.^2.*dbbMi.*pMi.^2.* ...
    xMi+65.*bbMi.^4.*dbbMi.*pMi.^4.*xMi+(-6).*bbMi.^3.*pMi.*(dxMi.* ...
    pMi+2.*dpMi.*xMi)+5.*bbMi.^5.*pMi.^3.*(dxMi.*pMi+4.*dpMi.*xMi)).* ...
    cos(3.*tt)+9.*bbMi.^8.*j2.^3.*(bbMi.*dyMi+9.*dbbMi.*yMi+(-66).* ...
    bbMi.^2.*dbbMi.*pMi.^2.*yMi+65.*bbMi.^4.*dbbMi.*pMi.^4.*yMi+(-6).* ...
    bbMi.^3.*pMi.*(dyMi.*pMi+2.*dpMi.*yMi)+5.*bbMi.^5.*pMi.^3.*(dyMi.* ...
    pMi+4.*dpMi.*yMi)).*sin(tt)+15.*bbMi.^2.*j2.*R.*(bbMi.*kC.*(1+(-1) ...
    .*bbMi.^2.*pMi.^2).*rhoC+kD.*((-3).*dbbMi+bbMi.*((-1)+bbMi.*pMi.*( ...
    5.*dbbMi.*pMi+bbMi.*(2.*dpMi+pMi)))).*rhoD).*sin(2.*tt)+bbMi.^8.* ...
    j2.^3.*(bbMi.*dyMi+9.*dbbMi.*yMi+(-66).*bbMi.^2.*dbbMi.*pMi.^2.* ...
    yMi+65.*bbMi.^4.*dbbMi.*pMi.^4.*yMi+(-6).*bbMi.^3.*pMi.*(dyMi.* ...
    pMi+2.*dpMi.*yMi)+5.*bbMi.^5.*pMi.^3.*(dyMi.*pMi+4.*dpMi.*yMi)).* ...
    sin(3.*tt))+(-8).*bbMi.^7.*j2.*(1+(-6).*bbMi.^2.*pMi.^2+5.* ...
    bbMi.^4.*pMi.^4).*R.*((-1).*kC.*rhoC+kD.*rhoD).*((-9).*cos(tt)+ ...
    cos(3.*tt)).*sin(tti)+2.*bbMi.^(-3).*j2.^(-1).*R.*(tt+(-1).*tti).* ...
    ((-2).*bbMi.^2.*kC.*(16+3.*bbMi.^4.*j2.*(4+6.*bbMi.^4.*j2+(-5).* ...
    bbMi.^2.*(4+3.*bbMi.^4.*j2).*pMi.^2+9.*bbMi.^8.*j2.*pMi.^4)).* ...
    rhoC+2.*kD.*(16.*bbMi.^2+4.*bbMi.*((-4).*dbbMi+3.*bbMi.^5.*j2)+2.* ...
    (2.*dbbMi+3.*bbMi.^5.*j2).*(4.*dbbMi+3.*bbMi.^5.*j2)+(-120).* ...
    bbMi.^8.*dpMi.*j2.*pMi+(-15).*bbMi.^7.*j2.*(4.*bbMi+20.*dbbMi+3.* ...
    bbMi.^5.*j2).*pMi.^2+27.*bbMi.^14.*j2.^2.*pMi.^4).*rhoD+bbMi.^6.* ...
    j2.^2.*((-1)+bbMi.^2.*pMi.^2).*((-1).*kC.*rhoC+kD.*rhoD).*((-32).* ...
    xMi.*cos(tti).^3+3.*bbMi.^4.*((24+(-156).*bbMi.^2.*pMi.^2).*cos( ...
    2.*tti)+7.*((-1)+bbMi.^2.*pMi.^2).*cos(4.*tti))+32.*yMi.*sin(tti) ...
    .^3))+(-120).*bbMi.^3.*((-1)+bbMi.^2.*pMi.^2).*R.*((-1).*kC.*rhoC+ ...
    kD.*rhoD).*sin(2.*tti));
  dx = (1/1536).*j2.*(48.*dxMi.*j2.^(-1).*(32+(-3).*bbMi.^7.*j2.^2.* ...
    pi.^2.*((-1)+5.*bbMi.^2.*pMi.^2).*((-8).*dbbMi+bbMi.*((-1)+5.* ...
    bbMi.*pMi.*(12.*dbbMi.*pMi+bbMi.*(4.*dpMi+pMi)))))+(-288).* ...
    bbMi.^6.*j2.*pi.^2.*(4.*bbMi.*dbbMi+14.*dbbMi.^2+(-225).*bbMi.^2.* ...
    dbbMi.^2.*pMi.^2+(-50).*bbMi.^3.*dbbMi.*pMi.*(2.*dpMi+pMi)+150.* ...
    bbMi.^5.*dbbMi.*pMi.^3.*(4.*dpMi+pMi)+25.*bbMi.^6.*dpMi.*pMi.^2.*( ...
    3.*dpMi+2.*pMi)+(-5).*bbMi.^4.*(dpMi.^2+2.*dpMi.*pMi+(-165).* ...
    dbbMi.^2.*pMi.^4)).*xMi+24.*bbMi.^(-4).*j2.^(-2).*(tt+(-1).*tti).* ...
    (bbMi.*j2.*(111.*bbMi.^11.*dyMi.*j2.^2+64.*dbbMi.*kD.*R.*rhoD.* ...
    xMi+(-32).*bbMi.*R.*(dxMi.*kD.*rhoD+(-1).*kC.*rhoC.*xMi+kD.*rhoD.* ...
    xMi)+288.*bbMi.^5.*dbbMi.^2.*j2.*yMi+888.*bbMi.^10.*dbbMi.*j2.^2.* ...
    yMi+(-7260).*bbMi.^12.*dbbMi.*j2.^2.*pMi.^2.*yMi+7380.*bbMi.^14.* ...
    dbbMi.*j2.^2.*pMi.^4.*yMi+192.*bbMi.^6.*dbbMi.*j2.*(dyMi+yMi)+( ...
    -726).*bbMi.^13.*j2.^2.*pMi.*(dyMi.*pMi+2.*dpMi.*yMi)+615.* ...
    bbMi.^15.*j2.^2.*pMi.^3.*(dyMi.*pMi+4.*dpMi.*yMi)+48.*bbMi.^7.* ...
    j2.*(dyMi+(-75).*dbbMi.^2.*pMi.^2.*yMi)+(-1440).*bbMi.^8.*dbbMi.* ...
    j2.*pMi.*(dyMi.*pMi+(2.*dpMi+pMi).*yMi)+(-240).*bbMi.^9.*j2.*( ...
    dyMi.*pMi.*(2.*dpMi+pMi)+dpMi.*(dpMi+2.*pMi).*yMi))+R.*((-1).*kC.* ...
    rhoC+kD.*rhoD).*(9.*bbMi.^10.*j2.^2.*(13+(-116).*bbMi.^2.*pMi.^2+ ...
    79.*bbMi.^4.*pMi.^4).*cos(tti)+12.*bbMi.^6.*j2.^2.*((-9)+11.* ...
    bbMi.^2.*pMi.^2).*xMi.*cos(2.*tti)+32.*R.*(kC.*rhoC+kD.*rhoD).* ...
    sin(tti)+bbMi.^6.*j2.^2.*(2.*bbMi.^4.*(40+(-279).*bbMi.^2.*pMi.^2+ ...
    203.*bbMi.^4.*pMi.^4).*cos(3.*tti)+3.*((-1)+bbMi.^2.*pMi.^2).*(6.* ...
    xMi.*cos(4.*tti)+(-13).*bbMi.^4.*((-1)+bbMi.^2.*pMi.^2).*cos(5.* ...
    tti)+(-48).*yMi.*cos(tti).*sin(tti).^3))))+9.*bbMi.^5.*(tt+(-1).* ...
    tti).^2.*(48.*bbMi.*j2.*((-1).*bbMi.*dxMi.*(1+(-5).*bbMi.^2.* ...
    pMi.^2).*(bbMi+8.*dbbMi+(-5).*bbMi.^2.*pMi.*(12.*dbbMi.*pMi+bbMi.* ...
    (4.*dpMi+pMi)))+(-2).*(4.*bbMi.*dbbMi+14.*dbbMi.^2+(-225).* ...
    bbMi.^2.*dbbMi.^2.*pMi.^2+(-50).*bbMi.^3.*dbbMi.*pMi.*(2.*dpMi+ ...
    pMi)+150.*bbMi.^5.*dbbMi.*pMi.^3.*(4.*dpMi+pMi)+25.*bbMi.^6.* ...
    dpMi.*pMi.^2.*(3.*dpMi+2.*pMi)+(-5).*bbMi.^4.*(dpMi.^2+2.*dpMi.* ...
    pMi+(-165).*dbbMi.^2.*pMi.^4)).*xMi)+(-72).*bbMi.^10.*j2.^2.*((-1) ...
    +5.*bbMi.^2.*pMi.^2).*(bbMi.^3.*dpMi.*pMi.*((-1)+48.*bbMi.^2.* ...
    pMi.^2+45.*bbMi.^4.*pMi.^4)+dbbMi.*((-2)+(-19).*bbMi.^2.*pMi.^2+ ...
    170.*bbMi.^4.*pMi.^4+135.*bbMi.^6.*pMi.^6)).*cos(tti)+(-12).* ...
    bbMi.*j2.*(3.*bbMi.^5.*j2.*((-6).*bbMi.*dxMi+(-72).*dbbMi.*xMi+ ...
    1218.*bbMi.^2.*dbbMi.*pMi.^2.*xMi+(-5440).*bbMi.^4.*dbbMi.* ...
    pMi.^4.*xMi+4950.*bbMi.^6.*dbbMi.*pMi.^6.*xMi+87.*bbMi.^3.*pMi.*( ...
    dxMi.*pMi+2.*dpMi.*xMi)+(-340).*bbMi.^5.*pMi.^3.*(dxMi.*pMi+4.* ...
    dpMi.*xMi)+275.*bbMi.^7.*pMi.^5.*(dxMi.*pMi+6.*dpMi.*xMi))+(-1).*( ...
    1+(-5).*bbMi.^2.*pMi.^2).^2.*R.*((-1).*kC.*rhoC+kD.*rhoD).*yMi).* ...
    cos(2.*tti)+12.*bbMi.^10.*j2.^2.*((-1)+5.*bbMi.^2.*pMi.^2).*( ...
    bbMi.^3.*dpMi.*pMi.*(223+(-1168).*bbMi.^2.*pMi.^2+1105.*bbMi.^4.* ...
    pMi.^4)+dbbMi.*((-122)+1397.*bbMi.^2.*pMi.^2+(-4430).*bbMi.^4.* ...
    pMi.^4+3315.*bbMi.^6.*pMi.^6)).*cos(3.*tti)+27.*bbMi.^6.*j2.^2.*(( ...
    -1)+5.*bbMi.^2.*pMi.^2).*(bbMi.*dxMi+12.*dbbMi.*xMi+(-94).* ...
    bbMi.^2.*dbbMi.*pMi.^2.*xMi+90.*bbMi.^4.*dbbMi.*pMi.^4.*xMi+5.* ...
    bbMi.^5.*pMi.^3.*(dxMi.*pMi+6.*dpMi.*xMi)+(-2).*bbMi.^3.*pMi.*(3.* ...
    dxMi.*pMi+11.*dpMi.*xMi)).*cos(4.*tti)+(-468).*bbMi.^10.*j2.^2.*( ...
    1+(-6).*bbMi.^2.*pMi.^2+5.*bbMi.^4.*pMi.^4).*(bbMi.^3.*dpMi.*pMi.* ...
    ((-3)+5.*bbMi.^2.*pMi.^2)+dbbMi.*(2+(-15).*bbMi.^2.*pMi.^2+15.* ...
    bbMi.^4.*pMi.^4)).*cos(5.*tti)+(-12).*((-1)+5.*bbMi.^2.*pMi.^2).* ...
    R.*(bbMi.*kC.*((-4)+(-11).*bbMi.^4.*j2+4.*bbMi.^2.*(5+24.* ...
    bbMi.^4.*j2).*pMi.^2+(-85).*bbMi.^8.*j2.*pMi.^4).*rhoC+kD.*(4.* ...
    bbMi+24.*dbbMi+11.*bbMi.^5.*j2+(-80).*bbMi.^3.*dpMi.*pMi+(-4).* ...
    bbMi.^2.*(5.*bbMi+50.*dbbMi+24.*bbMi.^5.*j2).*pMi.^2+85.*bbMi.^9.* ...
    j2.*pMi.^4).*rhoD).*sin(tti)+(-12).*bbMi.*j2.*((-1)+5.*bbMi.^2.* ...
    pMi.^2).*(((-1)+5.*bbMi.^2.*pMi.^2).*(6.*bbMi.^6.*dyMi.*j2.*((-1)+ ...
    2.*bbMi.^2.*pMi.^2)+R.*((-1).*kC.*rhoC+kD.*rhoD).*xMi)+72.* ...
    bbMi.^5.*j2.*(dbbMi+(-2).*bbMi.^3.*dpMi.*pMi+(-9).*bbMi.^2.* ...
    dbbMi.*pMi.^2+5.*bbMi.^5.*dpMi.*pMi.^3+15.*bbMi.^4.*dbbMi.*pMi.^4) ...
    .*yMi).*sin(2.*tti)+4.*bbMi.^5.*j2.*((-1)+bbMi.*pMi).*(1+bbMi.* ...
    pMi).*((-1)+5.*bbMi.^2.*pMi.^2).*((-29)+235.*bbMi.^2.*pMi.^2).*R.* ...
    ((-1).*kC.*rhoC+kD.*rhoD).*sin(3.*tti)+27.*bbMi.^6.*j2.^2.*((-1)+ ...
    5.*bbMi.^2.*pMi.^2).*(bbMi.*dyMi+12.*dbbMi.*yMi+(-94).*bbMi.^2.* ...
    dbbMi.*pMi.^2.*yMi+90.*bbMi.^4.*dbbMi.*pMi.^4.*yMi+5.*bbMi.^5.* ...
    pMi.^3.*(dyMi.*pMi+6.*dpMi.*yMi)+(-2).*bbMi.^3.*pMi.*(3.*dyMi.* ...
    pMi+11.*dpMi.*yMi)).*sin(4.*tti))+bbMi.*j2.^(-1).*(36.*bbMi.^14.* ...
    j2.^3.*pi.^2.*((-1)+5.*bbMi.^2.*pMi.^2).*(bbMi.^3.*dpMi.*pMi.*( ...
    223+(-1168).*bbMi.^2.*pMi.^2+1105.*bbMi.^4.*pMi.^4)+dbbMi.*((-122) ...
    +1397.*bbMi.^2.*pMi.^2+(-4430).*bbMi.^4.*pMi.^4+3315.*bbMi.^6.* ...
    pMi.^6)).*cos(3.*tti)+81.*bbMi.^10.*j2.^3.*pi.^2.*((-1)+5.* ...
    bbMi.^2.*pMi.^2).*(bbMi.*dxMi+12.*dbbMi.*xMi+(-94).*bbMi.^2.* ...
    dbbMi.*pMi.^2.*xMi+90.*bbMi.^4.*dbbMi.*pMi.^4.*xMi+5.*bbMi.^5.* ...
    pMi.^3.*(dxMi.*pMi+6.*dpMi.*xMi)+(-2).*bbMi.^3.*pMi.*(3.*dxMi.* ...
    pMi+11.*dpMi.*xMi)).*cos(4.*tti)+(-1404).*bbMi.^14.*j2.^3.*pi.^2.* ...
    (1+(-6).*bbMi.^2.*pMi.^2+5.*bbMi.^4.*pMi.^4).*(bbMi.^3.*dpMi.* ...
    pMi.*((-3)+5.*bbMi.^2.*pMi.^2)+dbbMi.*(2+(-15).*bbMi.^2.*pMi.^2+ ...
    15.*bbMi.^4.*pMi.^4)).*cos(5.*tti)+12.*bbMi.^5.*j2.*cos(2.*tti).*( ...
    3.*j2.*pi.^2.*(3.*bbMi.^5.*j2.*(6.*bbMi.*dxMi+72.*dbbMi.*xMi+( ...
    -1218).*bbMi.^2.*dbbMi.*pMi.^2.*xMi+5440.*bbMi.^4.*dbbMi.*pMi.^4.* ...
    xMi+(-4950).*bbMi.^6.*dbbMi.*pMi.^6.*xMi+(-87).*bbMi.^3.*pMi.*( ...
    dxMi.*pMi+2.*dpMi.*xMi)+340.*bbMi.^5.*pMi.^3.*(dxMi.*pMi+4.*dpMi.* ...
    xMi)+(-275).*bbMi.^7.*pMi.^5.*(dxMi.*pMi+6.*dpMi.*xMi))+(1+(-5).* ...
    bbMi.^2.*pMi.^2).^2.*R.*((-1).*kC.*rhoC+kD.*rhoD).*yMi)+32.*((-1)+ ...
    bbMi.^2.*pMi.^2).*R.*((-1).*kC.*rhoC+kD.*rhoD).*(1+(-38).* ...
    bbMi.^2.*pMi.^2+7.*((-1)+2.*bbMi.^2.*pMi.^2).*cos(2.*tt)).*sin(tt) ...
    )+108.*bbMi.^5.*j2.*((-1)+5.*bbMi.^2.*pMi.^2).*cos(tti).*(2.* ...
    bbMi.^9.*j2.^2.*pi.^2.*(bbMi.^3.*dpMi.*pMi.*(1+(-48).*bbMi.^2.* ...
    pMi.^2+(-45).*bbMi.^4.*pMi.^4)+dbbMi.*(2+19.*bbMi.^2.*pMi.^2+( ...
    -170).*bbMi.^4.*pMi.^4+(-135).*bbMi.^6.*pMi.^6))+R.*((-1).*kC.* ...
    rhoC+kD.*rhoD).*((-8)+4.*bbMi.^2.*pMi.^2+3.*((-1)+bbMi.^2.*pMi.^2) ...
    .*cos(2.*tt)).*sin(2.*tt))+2.*((-432).*bbMi.^6.*j2.^2.*(bbMi.* ...
    dxMi+8.*dbbMi.*xMi+(-70).*bbMi.^2.*dbbMi.*pMi.^2.*xMi+120.* ...
    bbMi.^4.*dbbMi.*pMi.^4.*xMi+(-7).*bbMi.^3.*pMi.*(dxMi.*pMi+2.* ...
    dpMi.*xMi)+10.*bbMi.^5.*pMi.^3.*(dxMi.*pMi+4.*dpMi.*xMi)).*cos(2.* ...
    tt)+81.*bbMi.^6.*j2.^2.*(bbMi.*dxMi+8.*dbbMi.*xMi+(-60).*bbMi.^2.* ...
    dbbMi.*pMi.^2.*xMi+60.*bbMi.^4.*dbbMi.*pMi.^4.*xMi+(-6).*bbMi.^3.* ...
    pMi.*(dxMi.*pMi+2.*dpMi.*xMi)+5.*bbMi.^5.*pMi.^3.*(dxMi.*pMi+4.* ...
    dpMi.*xMi)).*cos(4.*tt)+(-576).*R.*(bbMi.*kC.*(1+(-5).*bbMi.^2.* ...
    pMi.^2).*rhoC+kD.*((-2).*dbbMi+bbMi.*((-1)+5.*bbMi.*pMi.*(4.* ...
    dbbMi.*pMi+bbMi.*(2.*dpMi+pMi)))).*rhoD).*sin(tt)+216.*bbMi.^6.* ...
    j2.^2.*(2.*bbMi.*dyMi+16.*dbbMi.*yMi+(-110).*bbMi.^2.*dbbMi.* ...
    pMi.^2.*yMi+60.*bbMi.^4.*dbbMi.*pMi.^4.*yMi+(-11).*bbMi.^3.*pMi.*( ...
    dyMi.*pMi+2.*dpMi.*yMi)+5.*bbMi.^5.*pMi.^3.*(dyMi.*pMi+4.*dpMi.* ...
    yMi)).*sin(2.*tt)+448.*R.*(bbMi.*kC.*(1+(-1).*bbMi.^2.*pMi.^2).* ...
    rhoC+kD.*((-2).*dbbMi+bbMi.*((-1)+bbMi.*pMi.*(4.*dbbMi.*pMi+bbMi.* ...
    (2.*dpMi+pMi)))).*rhoD).*sin(3.*tt)+81.*bbMi.^6.*j2.^2.*(bbMi.* ...
    dyMi+8.*dbbMi.*yMi+(-60).*bbMi.^2.*dbbMi.*pMi.^2.*yMi+60.* ...
    bbMi.^4.*dbbMi.*pMi.^4.*yMi+(-6).*bbMi.^3.*pMi.*(dyMi.*pMi+2.* ...
    dpMi.*yMi)+5.*bbMi.^5.*pMi.^3.*(dyMi.*pMi+4.*dpMi.*yMi)).*sin(4.* ...
    tt))+(-18).*bbMi.*((-1)+5.*bbMi.^2.*pMi.^2).*R.*(2.*kC.*(32+ ...
    bbMi.^4.*j2.*pi.^2.*((-4)+(-11).*bbMi.^4.*j2+4.*bbMi.^2.*(5+24.* ...
    bbMi.^4.*j2).*pMi.^2+(-85).*bbMi.^8.*j2.*pMi.^4)).*rhoC+2.*kD.*(( ...
    -32)+bbMi.^3.*j2.*pi.^2.*(4.*bbMi+24.*dbbMi+11.*bbMi.^5.*j2+(-80) ...
    .*bbMi.^3.*dpMi.*pMi+(-4).*bbMi.^2.*(5.*bbMi+50.*dbbMi+24.* ...
    bbMi.^5.*j2).*pMi.^2+85.*bbMi.^9.*j2.*pMi.^4)).*rhoD+3.*bbMi.^4.* ...
    j2.*((-1).*kC.*rhoC+kD.*rhoD).*((16+(-32).*bbMi.^2.*pMi.^2).*cos( ...
    2.*tt)+3.*((-1)+bbMi.^2.*pMi.^2).*cos(4.*tt))).*sin(tti)+(-36).* ...
    bbMi.^5.*j2.^2.*pi.^2.*((-1)+5.*bbMi.^2.*pMi.^2).*(((-1)+5.* ...
    bbMi.^2.*pMi.^2).*(6.*bbMi.^6.*dyMi.*j2.*((-1)+2.*bbMi.^2.*pMi.^2) ...
    +R.*((-1).*kC.*rhoC+kD.*rhoD).*xMi)+72.*bbMi.^5.*j2.*(dbbMi+(-2).* ...
    bbMi.^3.*dpMi.*pMi+(-9).*bbMi.^2.*dbbMi.*pMi.^2+5.*bbMi.^5.*dpMi.* ...
    pMi.^3+15.*bbMi.^4.*dbbMi.*pMi.^4).*yMi).*sin(2.*tti)+4.*bbMi.*(( ...
    -1)+bbMi.^2.*pMi.^2).*((-224)+3.*bbMi.^8.*j2.^2.*pi.^2.*(29+(-380) ...
    .*bbMi.^2.*pMi.^2+1175.*bbMi.^4.*pMi.^4)).*R.*((-1).*kC.*rhoC+kD.* ...
    rhoD).*sin(3.*tti)+81.*bbMi.^10.*j2.^3.*pi.^2.*((-1)+5.*bbMi.^2.* ...
    pMi.^2).*(bbMi.*dyMi+12.*dbbMi.*yMi+(-94).*bbMi.^2.*dbbMi.* ...
    pMi.^2.*yMi+90.*bbMi.^4.*dbbMi.*pMi.^4.*yMi+5.*bbMi.^5.*pMi.^3.*( ...
    dyMi.*pMi+6.*dpMi.*yMi)+(-2).*bbMi.^3.*pMi.*(3.*dyMi.*pMi+11.* ...
    dpMi.*yMi)).*sin(4.*tti)));
  dy = (1/1536).*j2.*(48.*dyMi.*j2.^(-1).*(32+(-3).*bbMi.^7.*j2.^2.* ...
    pi.^2.*((-1)+5.*bbMi.^2.*pMi.^2).*((-8).*dbbMi+bbMi.*((-1)+5.* ...
    bbMi.*pMi.*(12.*dbbMi.*pMi+bbMi.*(4.*dpMi+pMi)))))+(-288).* ...
    bbMi.^6.*j2.*pi.^2.*(4.*bbMi.*dbbMi+14.*dbbMi.^2+(-225).*bbMi.^2.* ...
    dbbMi.^2.*pMi.^2+(-50).*bbMi.^3.*dbbMi.*pMi.*(2.*dpMi+pMi)+150.* ...
    bbMi.^5.*dbbMi.*pMi.^3.*(4.*dpMi+pMi)+25.*bbMi.^6.*dpMi.*pMi.^2.*( ...
    3.*dpMi+2.*pMi)+(-5).*bbMi.^4.*(dpMi.^2+2.*dpMi.*pMi+(-165).* ...
    dbbMi.^2.*pMi.^4)).*yMi+(-1).*bbMi.*j2.^(-1).*(18.*bbMi.*R.*(2.* ...
    kC.*(96+(-224).*bbMi.^2.*pMi.^2+(-1).*bbMi.^4.*j2.*pi.^2.*((-1)+ ...
    5.*bbMi.^2.*pMi.^2).*((-4)+11.*bbMi.^4.*j2+4.*bbMi.^2.*(5+(-24).* ...
    bbMi.^4.*j2).*pMi.^2+85.*bbMi.^8.*j2.*pMi.^4)).*rhoC+2.*kD.*((-96) ...
    +224.*bbMi.^2.*pMi.^2+bbMi.^3.*j2.*pi.^2.*((-1)+5.*bbMi.^2.* ...
    pMi.^2).*((-4).*bbMi+(-24).*dbbMi+11.*bbMi.^5.*j2+80.*bbMi.^3.* ...
    dpMi.*pMi+4.*bbMi.^2.*(5.*bbMi+50.*dbbMi+(-24).*bbMi.^5.*j2).* ...
    pMi.^2+85.*bbMi.^9.*j2.*pMi.^4)).*rhoD+3.*bbMi.^4.*j2.*(1+(-6).* ...
    bbMi.^2.*pMi.^2+5.*bbMi.^4.*pMi.^4).*((-1).*kC.*rhoC+kD.*rhoD).*( ...
    8.*cos(2.*tt)+3.*cos(4.*tt))).*cos(tti)+12.*bbMi.^5.*j2.*(3.*j2.* ...
    pi.^2.*(((-1)+5.*bbMi.^2.*pMi.^2).*(3.*bbMi.^6.*dyMi.*j2.*(5+(-49) ...
    .*bbMi.^2.*pMi.^2+40.*bbMi.^4.*pMi.^4)+(-1).*((-1)+5.*bbMi.^2.* ...
    pMi.^2).*R.*((-1).*kC.*rhoC+kD.*rhoD).*xMi)+12.*bbMi.^5.*j2.*( ...
    bbMi.^3.*dpMi.*pMi.*(37+(-285).*bbMi.^2.*pMi.^2+300.*bbMi.^4.* ...
    pMi.^4)+dbbMi.*((-15)+259.*bbMi.^2.*pMi.^2+(-1140).*bbMi.^4.* ...
    pMi.^4+900.*bbMi.^6.*pMi.^6)).*yMi)+32.*((-1)+bbMi.^2.*pMi.^2).* ...
    R.*((-1).*kC.*rhoC+kD.*rhoD).*cos(tt).*(17+(-70).*bbMi.^2.*pMi.^2+ ...
    7.*((-1)+2.*bbMi.^2.*pMi.^2).*cos(2.*tt))).*cos(2.*tti)+4.*bbMi.*( ...
    (-1)+bbMi.^2.*pMi.^2).*((-224)+3.*bbMi.^8.*j2.^2.*pi.^2.*(29+( ...
    -380).*bbMi.^2.*pMi.^2+1175.*bbMi.^4.*pMi.^4)).*R.*((-1).*kC.* ...
    rhoC+kD.*rhoD).*cos(3.*tti)+81.*bbMi.^10.*j2.^3.*pi.^2.*((-1)+5.* ...
    bbMi.^2.*pMi.^2).*(bbMi.*dyMi+12.*dbbMi.*yMi+(-94).*bbMi.^2.* ...
    dbbMi.*pMi.^2.*yMi+90.*bbMi.^4.*dbbMi.*pMi.^4.*yMi+5.*bbMi.^5.* ...
    pMi.^3.*(dyMi.*pMi+6.*dpMi.*yMi)+(-2).*bbMi.^3.*pMi.*(3.*dyMi.* ...
    pMi+11.*dpMi.*yMi)).*cos(4.*tti)+2.*((-576).*R.*(bbMi.*kC.*(3+(-7) ...
    .*bbMi.^2.*pMi.^2).*rhoC+kD.*((-6).*dbbMi+bbMi.*((-3)+7.*bbMi.* ...
    pMi.*(4.*dbbMi.*pMi+bbMi.*(2.*dpMi+pMi)))).*rhoD).*cos(tt)+216.* ...
    bbMi.^6.*j2.^2.*(bbMi.*dyMi+8.*dbbMi.*yMi+(-60).*bbMi.^2.*dbbMi.* ...
    pMi.^2.*yMi+60.*bbMi.^4.*dbbMi.*pMi.^4.*yMi+(-6).*bbMi.^3.*pMi.*( ...
    dyMi.*pMi+2.*dpMi.*yMi)+5.*bbMi.^5.*pMi.^3.*(dyMi.*pMi+4.*dpMi.* ...
    yMi)).*cos(2.*tt)+448.*R.*(bbMi.*kC.*(1+(-1).*bbMi.^2.*pMi.^2).* ...
    rhoC+kD.*((-2).*dbbMi+bbMi.*((-1)+bbMi.*pMi.*(4.*dbbMi.*pMi+bbMi.* ...
    (2.*dpMi+pMi)))).*rhoD).*cos(3.*tt)+81.*bbMi.^6.*j2.^2.*(bbMi.* ...
    dyMi+8.*dbbMi.*yMi+(-60).*bbMi.^2.*dbbMi.*pMi.^2.*yMi+60.* ...
    bbMi.^4.*dbbMi.*pMi.^4.*yMi+(-6).*bbMi.^3.*pMi.*(dyMi.*pMi+2.* ...
    dpMi.*yMi)+5.*bbMi.^5.*pMi.^3.*(dyMi.*pMi+4.*dpMi.*yMi)).*cos(4.* ...
    tt)+216.*bbMi.^6.*j2.^2.*(3.*bbMi.*dxMi+24.*dbbMi.*xMi+(-190).* ...
    bbMi.^2.*dbbMi.*pMi.^2.*xMi+240.*bbMi.^4.*dbbMi.*pMi.^4.*xMi+(-19) ...
    .*bbMi.^3.*pMi.*(dxMi.*pMi+2.*dpMi.*xMi)+20.*bbMi.^5.*pMi.^3.*( ...
    dxMi.*pMi+4.*dpMi.*xMi)).*sin(2.*tt)+(-81).*bbMi.^6.*j2.^2.*( ...
    bbMi.*dxMi+8.*dbbMi.*xMi+(-60).*bbMi.^2.*dbbMi.*pMi.^2.*xMi+60.* ...
    bbMi.^4.*dbbMi.*pMi.^4.*xMi+(-6).*bbMi.^3.*pMi.*(dxMi.*pMi+2.* ...
    dpMi.*xMi)+5.*bbMi.^5.*pMi.^3.*(dxMi.*pMi+4.*dpMi.*xMi)).*sin(4.* ...
    tt))+54.*bbMi.^5.*j2.*((-1)+5.*bbMi.^2.*pMi.^2).*(12.*bbMi.^9.* ...
    j2.^2.*pi.^2.*((-14).*dbbMi+5.*bbMi.^2.*dbbMi.*pMi.^2.*(31+(-98).* ...
    bbMi.^2.*pMi.^2+93.*bbMi.^4.*pMi.^4)+bbMi.^3.*dpMi.*pMi.*(25+( ...
    -128).*bbMi.^2.*pMi.^2+155.*bbMi.^4.*pMi.^4))+R.*((-1).*kC.*rhoC+ ...
    kD.*rhoD).*(8.*(3+(-4).*bbMi.^2.*pMi.^2).*sin(2.*tt)+3.*((-1)+ ...
    bbMi.^2.*pMi.^2).*sin(4.*tt))).*sin(tti)+(-36).*bbMi.^5.*j2.^2.* ...
    pi.^2.*((-1)+5.*bbMi.^2.*pMi.^2).*(3.*bbMi.^5.*j2.*(bbMi.*dxMi+ ...
    12.*dbbMi.*xMi+(-94).*bbMi.^2.*dbbMi.*pMi.^2.*xMi+90.*bbMi.^4.* ...
    dbbMi.*pMi.^4.*xMi+5.*bbMi.^5.*pMi.^3.*(dxMi.*pMi+6.*dpMi.*xMi)+( ...
    -2).*bbMi.^3.*pMi.*(3.*dxMi.*pMi+11.*dpMi.*xMi))+((-1)+5.* ...
    bbMi.^2.*pMi.^2).*R.*((-1).*kC.*rhoC+kD.*rhoD).*yMi).*sin(2.*tti)+ ...
    (-36).*bbMi.^14.*j2.^3.*pi.^2.*((-1)+5.*bbMi.^2.*pMi.^2).*( ...
    bbMi.^3.*dpMi.*pMi.*(313+(-1408).*bbMi.^2.*pMi.^2+1255.*bbMi.^4.* ...
    pMi.^4)+dbbMi.*((-182)+1907.*bbMi.^2.*pMi.^2+(-5330).*bbMi.^4.* ...
    pMi.^4+3765.*bbMi.^6.*pMi.^6)).*sin(3.*tti)+(-81).*bbMi.^10.* ...
    j2.^3.*pi.^2.*((-1)+5.*bbMi.^2.*pMi.^2).*(bbMi.*dxMi+12.*dbbMi.* ...
    xMi+(-94).*bbMi.^2.*dbbMi.*pMi.^2.*xMi+90.*bbMi.^4.*dbbMi.* ...
    pMi.^4.*xMi+5.*bbMi.^5.*pMi.^3.*(dxMi.*pMi+6.*dpMi.*xMi)+(-2).* ...
    bbMi.^3.*pMi.*(3.*dxMi.*pMi+11.*dpMi.*xMi)).*sin(4.*tti)+1404.* ...
    bbMi.^14.*j2.^3.*pi.^2.*(1+(-6).*bbMi.^2.*pMi.^2+5.*bbMi.^4.* ...
    pMi.^4).*(bbMi.^3.*dpMi.*pMi.*((-3)+5.*bbMi.^2.*pMi.^2)+dbbMi.*(2+ ...
    (-15).*bbMi.^2.*pMi.^2+15.*bbMi.^4.*pMi.^4)).*sin(5.*tti))+(-9).* ...
    bbMi.^5.*(tt+(-1).*tti).^2.*(12.*((-1)+5.*bbMi.^2.*pMi.^2).*R.*( ...
    bbMi.*kC.*(4+(-11).*bbMi.^4.*j2+4.*bbMi.^2.*((-5)+24.*bbMi.^4.*j2) ...
    .*pMi.^2+(-85).*bbMi.^8.*j2.*pMi.^4).*rhoC+kD.*((-4).*bbMi+(-24).* ...
    dbbMi+11.*bbMi.^5.*j2+80.*bbMi.^3.*dpMi.*pMi+4.*bbMi.^2.*(5.*bbMi+ ...
    50.*dbbMi+(-24).*bbMi.^5.*j2).*pMi.^2+85.*bbMi.^9.*j2.*pMi.^4).* ...
    rhoD).*cos(tti)+(-1).*bbMi.*j2.*((-48).*bbMi.*dyMi.*((-1)+5.* ...
    bbMi.^2.*pMi.^2).*((-8).*dbbMi+bbMi.*((-1)+5.*bbMi.*pMi.*(12.* ...
    dbbMi.*pMi+bbMi.*(4.*dpMi+pMi))))+(-96).*(4.*bbMi.*dbbMi+14.* ...
    dbbMi.^2+(-225).*bbMi.^2.*dbbMi.^2.*pMi.^2+(-50).*bbMi.^3.*dbbMi.* ...
    pMi.*(2.*dpMi+pMi)+150.*bbMi.^5.*dbbMi.*pMi.^3.*(4.*dpMi+pMi)+25.* ...
    bbMi.^6.*dpMi.*pMi.^2.*(3.*dpMi+2.*pMi)+(-5).*bbMi.^4.*(dpMi.^2+ ...
    2.*dpMi.*pMi+(-165).*dbbMi.^2.*pMi.^4)).*yMi+(-12).*(((-1)+5.* ...
    bbMi.^2.*pMi.^2).*(3.*bbMi.^6.*dyMi.*j2.*(5+(-49).*bbMi.^2.* ...
    pMi.^2+40.*bbMi.^4.*pMi.^4)+(-1).*((-1)+5.*bbMi.^2.*pMi.^2).*R.*(( ...
    -1).*kC.*rhoC+kD.*rhoD).*xMi)+12.*bbMi.^5.*j2.*(bbMi.^3.*dpMi.* ...
    pMi.*(37+(-285).*bbMi.^2.*pMi.^2+300.*bbMi.^4.*pMi.^4)+dbbMi.*(( ...
    -15)+259.*bbMi.^2.*pMi.^2+(-1140).*bbMi.^4.*pMi.^4+900.*bbMi.^6.* ...
    pMi.^6)).*yMi).*cos(2.*tti)+(-4).*bbMi.^4.*((-1)+bbMi.*pMi).*(1+ ...
    bbMi.*pMi).*((-1)+5.*bbMi.^2.*pMi.^2).*((-29)+235.*bbMi.^2.* ...
    pMi.^2).*R.*((-1).*kC.*rhoC+kD.*rhoD).*cos(3.*tti)+(-27).* ...
    bbMi.^5.*j2.*((-1)+5.*bbMi.^2.*pMi.^2).*(bbMi.*dyMi+12.*dbbMi.* ...
    yMi+(-94).*bbMi.^2.*dbbMi.*pMi.^2.*yMi+90.*bbMi.^4.*dbbMi.* ...
    pMi.^4.*yMi+5.*bbMi.^5.*pMi.^3.*(dyMi.*pMi+6.*dpMi.*yMi)+(-2).* ...
    bbMi.^3.*pMi.*(3.*dyMi.*pMi+11.*dpMi.*yMi)).*cos(4.*tti)+(-216).* ...
    bbMi.^9.*j2.*((-1)+5.*bbMi.^2.*pMi.^2).*((-14).*dbbMi+5.*bbMi.^2.* ...
    dbbMi.*pMi.^2.*(31+(-98).*bbMi.^2.*pMi.^2+93.*bbMi.^4.*pMi.^4)+ ...
    bbMi.^3.*dpMi.*pMi.*(25+(-128).*bbMi.^2.*pMi.^2+155.*bbMi.^4.* ...
    pMi.^4)).*sin(tti)+12.*((-1)+5.*bbMi.^2.*pMi.^2).*(3.*bbMi.^5.* ...
    j2.*(bbMi.*dxMi+12.*dbbMi.*xMi+(-94).*bbMi.^2.*dbbMi.*pMi.^2.*xMi+ ...
    90.*bbMi.^4.*dbbMi.*pMi.^4.*xMi+5.*bbMi.^5.*pMi.^3.*(dxMi.*pMi+6.* ...
    dpMi.*xMi)+(-2).*bbMi.^3.*pMi.*(3.*dxMi.*pMi+11.*dpMi.*xMi))+((-1) ...
    +5.*bbMi.^2.*pMi.^2).*R.*((-1).*kC.*rhoC+kD.*rhoD).*yMi).*sin(2.* ...
    tti)+12.*bbMi.^9.*j2.*((-1)+5.*bbMi.^2.*pMi.^2).*(bbMi.^3.*dpMi.* ...
    pMi.*(313+(-1408).*bbMi.^2.*pMi.^2+1255.*bbMi.^4.*pMi.^4)+dbbMi.*( ...
    (-182)+1907.*bbMi.^2.*pMi.^2+(-5330).*bbMi.^4.*pMi.^4+3765.* ...
    bbMi.^6.*pMi.^6)).*sin(3.*tti)+27.*bbMi.^5.*j2.*((-1)+5.*bbMi.^2.* ...
    pMi.^2).*(bbMi.*dxMi+12.*dbbMi.*xMi+(-94).*bbMi.^2.*dbbMi.* ...
    pMi.^2.*xMi+90.*bbMi.^4.*dbbMi.*pMi.^4.*xMi+5.*bbMi.^5.*pMi.^3.*( ...
    dxMi.*pMi+6.*dpMi.*xMi)+(-2).*bbMi.^3.*pMi.*(3.*dxMi.*pMi+11.* ...
    dpMi.*xMi)).*sin(4.*tti)+(-468).*bbMi.^9.*j2.*(1+(-6).*bbMi.^2.* ...
    pMi.^2+5.*bbMi.^4.*pMi.^4).*(bbMi.^3.*dpMi.*pMi.*((-3)+5.* ...
    bbMi.^2.*pMi.^2)+dbbMi.*(2+(-15).*bbMi.^2.*pMi.^2+15.*bbMi.^4.* ...
    pMi.^4)).*sin(5.*tti)))+24.*bbMi.^(-4).*j2.^(-2).*(tt+(-1).*tti).* ...
    (32.*R.^2.*(kC.^2.*rhoC.^2+(-1).*kD.^2.*rhoD.^2).*cos(tti)+bbMi.* ...
    j2.*(9.*bbMi.^11.*dxMi.*j2.^2+(-288).*bbMi.^5.*dbbMi.^2.*j2.*xMi+ ...
    72.*bbMi.^10.*dbbMi.*j2.^2.*xMi+(-1140).*bbMi.^12.*dbbMi.*j2.^2.* ...
    pMi.^2.*xMi+1260.*bbMi.^14.*dbbMi.*j2.^2.*pMi.^4.*xMi+(-192).* ...
    bbMi.^6.*dbbMi.*j2.*(dxMi+xMi)+(-114).*bbMi.^13.*j2.^2.*pMi.*( ...
    dxMi.*pMi+2.*dpMi.*xMi)+105.*bbMi.^15.*j2.^2.*pMi.^3.*(dxMi.*pMi+ ...
    4.*dpMi.*xMi)+(-48).*bbMi.^7.*j2.*(dxMi+(-75).*dbbMi.^2.*pMi.^2.* ...
    xMi)+1440.*bbMi.^8.*dbbMi.*j2.*pMi.*(dxMi.*pMi+(2.*dpMi+pMi).*xMi) ...
    +240.*bbMi.^9.*j2.*(dxMi.*pMi.*(2.*dpMi+pMi)+dpMi.*(dpMi+2.*pMi).* ...
    xMi)+64.*dbbMi.*kD.*R.*rhoD.*yMi+(-32).*bbMi.*R.*(dyMi.*kD.*rhoD+( ...
    -1).*kC.*rhoC.*yMi+kD.*rhoD.*yMi)+(-1).*bbMi.^5.*j2.*R.*((-1).* ...
    kC.*rhoC+kD.*rhoD).*(12.*(9+(-7).*bbMi.^2.*pMi.^2).*yMi.*cos(2.* ...
    tti)+18.*((-1)+bbMi.^2.*pMi.^2).*yMi.*cos(4.*tti)+3.*bbMi.^4.*(61+ ...
    (-392).*bbMi.^2.*pMi.^2+451.*bbMi.^4.*pMi.^4).*sin(tti)+12.*(3+( ...
    -7).*bbMi.^2.*pMi.^2).*xMi.*sin(2.*tti)+(-2).*bbMi.^4.*(55+(-309) ...
    .*bbMi.^2.*pMi.^2+218.*bbMi.^4.*pMi.^4).*sin(3.*tti)+(-18).*((-1)+ ...
    bbMi.^2.*pMi.^2).*xMi.*sin(4.*tti)+39.*bbMi.^4.*((-1)+bbMi.^2.* ...
    pMi.^2).^2.*sin(5.*tti)))));
  dp = dpMi+(1/64).*bbMi.^(-4).*R.*(tt+(-1).*tti).*((-96).*dbbMi.^2.*kD.* ...
    pMi.*rhoD+(-48).*bbMi.^5.*dbbMi.*j2.*kD.*pMi.*rhoD+480.*bbMi.^7.* ...
    dbbMi.*j2.*kD.*pMi.^3.*rhoD+64.*bbMi.*dbbMi.*kD.*(dpMi+pMi).*rhoD+ ...
    63.*bbMi.^10.*j2.^2.*pMi.*(kC.*rhoC+(-1).*kD.*rhoD)+99.*bbMi.^14.* ...
    j2.^2.*pMi.^5.*(kC.*rhoC+(-1).*kD.*rhoD)+162.*bbMi.^12.*j2.^2.* ...
    pMi.^3.*((-1).*kC.*rhoC+kD.*rhoD)+(-32).*bbMi.^2.*((-1).*kC.*pMi.* ...
    rhoC+kD.*(dpMi+pMi).*rhoD)+(-24).*bbMi.^6.*j2.*((-1).*kC.*pMi.* ...
    rhoC+kD.*(dpMi+pMi).*rhoD)+120.*bbMi.^8.*j2.*pMi.^2.*((-1).*kC.* ...
    pMi.*rhoC+kD.*(3.*dpMi+pMi).*rhoD)+bbMi.^6.*j2.^2.*pMi.*((-1)+ ...
    bbMi.^2.*pMi.^2).*((-1).*kC.*rhoC+kD.*rhoD).*(64.*xMi.*cos(tti) ...
    .^3+36.*bbMi.^4.*((-2)+11.*bbMi.^2.*pMi.^2).*cos(2.*tti)+(-33).* ...
    bbMi.^4.*((-1)+bbMi.^2.*pMi.^2).*cos(4.*tti)+(-64).*yMi.*sin(tti) ...
    .^3));
  doo = (1/64).*j2.*(64.*dooMi.*j2.^(-1)+(-1).*bbMi.*pi.^2.*R.*((-27).* ...
    bbMi.^10.*j2.^2.*kC.*pMi.*((-1)+bbMi.^2.*pMi.^2).^2.*rhoC+kD.*( ...
    32.*bbMi.^2.*dpMi+96.*dbbMi.^2.*pMi+27.*bbMi.^10.*j2.^2.*pMi+(-54) ...
    .*bbMi.^12.*j2.^2.*pMi.^3+27.*bbMi.^14.*j2.^2.*pMi.^5+96.*bbMi.* ...
    dbbMi.*(dpMi+pMi)).*rhoD)+(-4).*bbMi.^7.*j2.*pMi.*R.*((-1).*kC.* ...
    rhoC+kD.*rhoD).*(18.*j2.*pi.^2.*((-1)+bbMi.^2.*pMi.^2).*xMi+((-1)+ ...
    5.*bbMi.^2.*pMi.^2).*cos(3.*tt)).*cos(tti)+36.*bbMi.^7.*j2.*cos( ...
    tt).*(bbMi.*j2.*((-9).*dbbMi.*pMi.*yMi+55.*bbMi.^2.*dbbMi.* ...
    pMi.^3.*yMi+(-1).*bbMi.*(dyMi.*pMi+dpMi.*yMi)+5.*bbMi.^3.*pMi.^2.* ...
    (dyMi.*pMi+3.*dpMi.*yMi))+pMi.*((-1)+5.*bbMi.^2.*pMi.^2).*R.*((-1) ...
    .*kC.*rhoC+kD.*rhoD).*cos(tti))+(-6).*bbMi.^3.*R.*(kC.*pMi.*(8+( ...
    -3).*bbMi.^4.*j2.*pi.^2.*((-1)+bbMi.^2.*pMi.^2).*(4+(-3).* ...
    bbMi.^4.*j2+3.*bbMi.^6.*j2.*pMi.^2)).*rhoC+kD.*((-8).*pMi+3.* ...
    bbMi.^3.*j2.*pi.^2.*((-28).*dbbMi.*pMi+3.*bbMi.^5.*j2.*pMi+36.* ...
    bbMi.^2.*dbbMi.*pMi.^3+(-6).*bbMi.^7.*j2.*pMi.^3+3.*bbMi.^9.*j2.* ...
    pMi.^5+(-4).*bbMi.*(dpMi+pMi)+4.*bbMi.^3.*pMi.^2.*(3.*dpMi+pMi))) ...
    .*rhoD).*cos(2.*tti)+(-12).*bbMi.^2.*R.*cos(2.*tt).*((-4).*bbMi.* ...
    kC.*pMi.*rhoC+4.*kD.*(3.*dbbMi.*pMi+bbMi.*(dpMi+pMi)).*rhoD+9.* ...
    bbMi.^5.*j2.*pMi.*((-1)+bbMi.^2.*pMi.^2).*((-1).*kC.*rhoC+kD.* ...
    rhoD).*cos(2.*tti))+(-24).*bbMi.^7.*j2.^2.*pi.^2.*pMi.*((-1)+ ...
    bbMi.^2.*pMi.^2).*R.*((-1).*kC.*rhoC+kD.*rhoD).*xMi.*cos(3.*tti)+( ...
    -18).*bbMi.^11.*j2.^2.*pi.^2.*pMi.*(4+(-11).*bbMi.^2.*pMi.^2+7.* ...
    bbMi.^4.*pMi.^4).*R.*((-1).*kC.*rhoC+kD.*rhoD).*cos(4.*tti)+4.* ...
    bbMi.^8.*j2.^2.*((9.*dbbMi.*pMi.*yMi+(-55).*bbMi.^2.*dbbMi.* ...
    pMi.^3.*yMi+bbMi.*(dyMi.*pMi+dpMi.*yMi)+(-5).*bbMi.^3.*pMi.^2.*( ...
    dyMi.*pMi+3.*dpMi.*yMi)).*cos(3.*tt)+((-9).*dbbMi.*pMi.*xMi+55.* ...
    bbMi.^2.*dbbMi.*pMi.^3.*xMi+(-1).*bbMi.*(dxMi.*pMi+dpMi.*xMi)+5.* ...
    bbMi.^3.*pMi.^2.*(dxMi.*pMi+3.*dpMi.*xMi)).*((-27).*sin(tt)+sin( ...
    3.*tt)))+4.*bbMi.^7.*j2.*pMi.*R.*((-1).*kC.*rhoC+kD.*rhoD).*(18.* ...
    j2.*pi.^2.*((-1)+bbMi.^2.*pMi.^2).*yMi+27.*((-1)+5.*bbMi.^2.* ...
    pMi.^2).*sin(tt)+(1+(-5).*bbMi.^2.*pMi.^2).*sin(3.*tt)).*sin(tti)+ ...
    (-3).*bbMi.^2.*(tt+(-1).*tti).*(bbMi.*dpMi.*(32.*bbMi.^2+160.* ...
    bbMi.*dbbMi+320.*dbbMi.^2+16.*bbMi.^6.*j2+144.*bbMi.^5.*dbbMi.*j2+ ...
    (-37).*bbMi.^10.*j2.^2)+(160.*bbMi.^2.*dbbMi+320.*dbbMi.^3+576.* ...
    bbMi.^5.*dbbMi.^2.*j2+(-120).*bbMi.^9.*dpMi.^2.*j2+(-481).* ...
    bbMi.^10.*dbbMi.*j2.^2+16.*bbMi.*dbbMi.*(20.*dbbMi+9.*bbMi.^5.*j2) ...
    ).*pMi+(-120).*bbMi.^8.*dpMi.*j2.*(bbMi+11.*dbbMi+3.*bbMi.^5.*j2) ...
    .*pMi.^2+(-40).*bbMi.^7.*dbbMi.*j2.*(11.*bbMi+55.*dbbMi+45.* ...
    bbMi.^5.*j2).*pMi.^3+1325.*bbMi.^15.*dpMi.*j2.^2.*pMi.^4+4505.* ...
    bbMi.^14.*dbbMi.*j2.^2.*pMi.^5+(-4).*bbMi.*j2.*pMi.*R.*((-1).*kC.* ...
    rhoC+kD.*rhoD).*(16.*xMi.*sin(tti)+cos(tti).*((-16).*yMi+3.* ...
    bbMi.^4.*((-33)+25.*bbMi.^2.*pMi.^2).*sin(tti))))+(-3).*bbMi.*R.*( ...
    tt+(-1).*tti).^2.*((-1).*bbMi.^2.*kC.*pMi.*(32+27.*bbMi.^8.* ...
    j2.^2.*((-1)+bbMi.^2.*pMi.^2).^2).*rhoC+kD.*(96.*dbbMi.^2.*pMi+ ...
    27.*bbMi.^10.*j2.^2.*pMi+(-54).*bbMi.^12.*j2.^2.*pMi.^3+27.* ...
    bbMi.^14.*j2.^2.*pMi.^5+32.*bbMi.^2.*(dpMi+pMi)+96.*bbMi.*dbbMi.*( ...
    dpMi+pMi)).*rhoD+(-6).*bbMi.^5.*j2.*((-12).*bbMi.*j2.*pMi.*((-1)+ ...
    bbMi.^2.*pMi.^2).*((-1).*kC.*rhoC+kD.*rhoD).*xMi.*cos(tti)+(-3).*( ...
    (-1).*bbMi.*kC.*pMi.*((-1)+bbMi.^2.*pMi.^2).*(4+(-3).*bbMi.^4.*j2+ ...
    3.*bbMi.^6.*j2.*pMi.^2).*rhoC+kD.*((-28).*dbbMi.*pMi+3.*bbMi.^5.* ...
    j2.*pMi+36.*bbMi.^2.*dbbMi.*pMi.^3+(-6).*bbMi.^7.*j2.*pMi.^3+3.* ...
    bbMi.^9.*j2.*pMi.^5+(-4).*bbMi.*(dpMi+pMi)+4.*bbMi.^3.*pMi.^2.*( ...
    3.*dpMi+pMi)).*rhoD).*cos(2.*tti)+(-1).*bbMi.*j2.*pMi.*((-1)+ ...
    bbMi.^2.*pMi.^2).*((-1).*kC.*rhoC+kD.*rhoD).*(4.*xMi.*cos(3.*tti)+ ...
    3.*bbMi.^4.*((-4)+7.*bbMi.^2.*pMi.^2).*cos(4.*tti)+(-16).*yMi.* ...
    sin(tti).^3)))+(-24).*bbMi.^7.*j2.^2.*pi.^2.*pMi.*((-1)+bbMi.^2.* ...
    pMi.^2).*R.*((-1).*kC.*rhoC+kD.*rhoD).*yMi.*sin(3.*tti));
  dt = (1/1024).*bbMi.^(-8).*mu.^(-1/2).*(2.*((-1920).*bbMi.*dbbMi.^2.* ...
    kD.*pi.^2.*R.^(5/2).*rhoD+4480.*dbbMi.^3.*kD.*pi.^2.*R.^(5/2).* ...
    rhoD+32.*bbMi.^6.*dbbMi.*j2.*kD.*pi.^2.*R.^(5/2).*rhoD+(-32).* ...
    bbMi.^5.*dbbMi.^2.*j2.*kD.*pi.^2.*R.^(5/2).*rhoD+(-1080).* ...
    bbMi.^10.*dbbMi.*j2.^2.*kD.*pi.^2.*R.^(5/2).*rhoD+5400.*bbMi.^12.* ...
    dbbMi.*j2.^2.*kD.*pi.^2.*pMi.^2.*R.^(5/2).*rhoD+(-5040).* ...
    bbMi.^14.*dbbMi.*j2.^2.*kD.*pi.^2.*pMi.^4.*R.^(5/2).*rhoD+224.* ...
    bbMi.^9.*dpMi.*j2.*kD.*pi.^2.*(dpMi+2.*pMi).*R.^(5/2).*rhoD+(-360) ...
    .*bbMi.^11.*j2.^2.*pi.^2.*R.^(5/2).*((-1).*kC.*rhoC+kD.*rhoD)+( ...
    -2277).*bbMi.^17.*j2.^3.*pi.^2.*pMi.^2.*R.^(5/2).*((-1).*kC.*rhoC+ ...
    kD.*rhoD)+2556.*bbMi.^19.*j2.^3.*pi.^2.*pMi.^4.*R.^(5/2).*((-1).* ...
    kC.*rhoC+kD.*rhoD)+(-945).*bbMi.^21.*j2.^3.*pi.^2.*pMi.^6.*R.^( ...
    5/2).*((-1).*kC.*rhoC+kD.*rhoD)+1080.*bbMi.^13.*j2.^2.*pi.^2.* ...
    pMi.*R.^(5/2).*((-1).*kC.*pMi.*rhoC+2.*dpMi.*kD.*rhoD+kD.*pMi.* ...
    rhoD)+32.*bbMi.^8.*(16.*dtMi.*mu.^(1/2)+7.*dbbMi.*j2.*kD.*pi.^2.* ...
    pMi.*(2.*dpMi+pMi).*R.^(5/2).*rhoD)+18.*bbMi.^15.*j2.^2.*pi.^2.* ...
    R.^(5/2).*(37.*j2.*((-1).*kC.*rhoC+kD.*rhoD)+(-40).*pMi.^3.*((-1) ...
    .*kC.*pMi.*rhoC+4.*dpMi.*kD.*rhoD+kD.*pMi.*rhoD)))+bbMi.*R.^(3/2) ...
    .*((-15).*bbMi.^14.*j2.^3.*pi.^2.*((-1)+bbMi.^2.*pMi.^2).^2.*(7+ ...
    5.*bbMi.^2.*pMi.^2).*R.*((-1).*kC.*rhoC+kD.*rhoD).*cos(6.*tti)+ ...
    12.*bbMi.^10.*j2.^2.*cos(5.*tti).*(15.*j2.*pi.^2.*((-1)+bbMi.^4.* ...
    pMi.^4).*R.*((-1).*kC.*rhoC+kD.*rhoD).*xMi+416.*((-1)+bbMi.^2.* ...
    pMi.^2).^2.*R.*((-1).*kC.*rhoC+kD.*rhoD).*cos(tt)+(-117).* ...
    bbMi.^9.*j2.^2.*(1+(-6).*bbMi.^2.*pMi.^2+5.*bbMi.^4.*pMi.^4).*(8.* ...
    bbMi.^3.*dpMi.*pMi.*((-3)+5.*bbMi.^2.*pMi.^2)+dbbMi.*(13+(-102).* ...
    bbMi.^2.*pMi.^2+105.*bbMi.^4.*pMi.^4)).*sin(tt))+4.*bbMi.^5.* ...
    j2.^2.*cos(3.*tti).*(2.*pi.^2.*R.*(40.*bbMi.*dxMi.*kD.*((-1)+ ...
    bbMi.^2.*pMi.^2).*rhoD+bbMi.*kC.*((-1)+bbMi.^2.*pMi.^2).*((-40)+( ...
    -47).*bbMi.^4.*j2+76.*bbMi.^6.*j2.*pMi.^2).*rhoC.*xMi+kD.*((-40).* ...
    bbMi+40.*dbbMi+(-47).*bbMi.^5.*j2+80.*bbMi.^3.*dpMi.*pMi+bbMi.^2.* ...
    (40.*bbMi+40.*dbbMi+123.*bbMi.^5.*j2).*pMi.^2+(-76).*bbMi.^9.*j2.* ...
    pMi.^4).*rhoD.*xMi)+4.*bbMi.^5.*((-418)+(-93).*bbMi.^4.*j2+3.* ...
    bbMi.^2.*(720+521.*bbMi.^4.*j2).*pMi.^2+(-1).*bbMi.^4.*(1598+ ...
    6495.*bbMi.^4.*j2).*pMi.^4+5025.*bbMi.^10.*j2.*pMi.^6).*R.*((-1).* ...
    kC.*rhoC+kD.*rhoD).*cos(tt)+9.*bbMi.^14.*j2.^2.*((-1)+5.*bbMi.^2.* ...
    pMi.^2).*(8.*bbMi.^3.*dpMi.*pMi.*(223+(-1168).*bbMi.^2.*pMi.^2+ ...
    1105.*bbMi.^4.*pMi.^4)+dbbMi.*((-793)+9415.*bbMi.^2.*pMi.^2+( ...
    -30547).*bbMi.^4.*pMi.^4+23205.*bbMi.^6.*pMi.^6)).*sin(tt))+12.* ...
    bbMi.^6.*j2.^2.*cos(4.*tti).*((-1).*bbMi.^3.*pi.^2.*((-1)+ ...
    bbMi.^2.*pMi.^2).*R.*(bbMi.*kC.*(10+(-41).*bbMi.^4.*j2+2.* ...
    bbMi.^2.*((-5)+72.*bbMi.^4.*j2).*pMi.^2+(-79).*bbMi.^8.*j2.* ...
    pMi.^4).*rhoC+kD.*((-10).*bbMi+(-30).*dbbMi+41.*bbMi.^5.*j2+40.* ...
    bbMi.^3.*dpMi.*pMi+2.*bbMi.^2.*(5.*bbMi+35.*dbbMi+(-72).*bbMi.^5.* ...
    j2).*pMi.^2+79.*bbMi.^9.*j2.*pMi.^4).*rhoD)+6.*(((-1)+bbMi.^2.* ...
    pMi.^2).*(9.*bbMi.^10.*dyMi.*j2.^2.*(1+(-5).*bbMi.^2.*pMi.^2).^2+ ...
    32.*R.*(kC.*rhoC+(-1).*kD.*rhoD).*xMi)+9.*bbMi.^9.*j2.^2.*((-1)+ ...
    5.*bbMi.^2.*pMi.^2).*((-22).*bbMi.^3.*dpMi.*pMi+30.*bbMi.^5.* ...
    dpMi.*pMi.^3+dbbMi.*(9+(-76).*bbMi.^2.*pMi.^2+75.*bbMi.^4.*pMi.^4) ...
    ).*yMi).*cos(tt)+6.*(9.*bbMi.^9.*j2.^2.*((-1)+5.*bbMi.^2.*pMi.^2) ...
    .*(bbMi.*dxMi+9.*dbbMi.*xMi+(-76).*bbMi.^2.*dbbMi.*pMi.^2.*xMi+ ...
    75.*bbMi.^4.*dbbMi.*pMi.^4.*xMi+5.*bbMi.^5.*pMi.^3.*(dxMi.*pMi+6.* ...
    dpMi.*xMi)+(-2).*bbMi.^3.*pMi.*(3.*dxMi.*pMi+11.*dpMi.*xMi))+32.*( ...
    (-1)+bbMi.^2.*pMi.^2).*R.*((-1).*kC.*rhoC+kD.*rhoD).*yMi).*sin(tt) ...
    )+bbMi.^6.*j2.*cos(2.*tti).*(R.*(kC.*(32+(-224).*bbMi.^2.*pMi.^2+( ...
    -3).*bbMi.^4.*j2.*pi.^2.*((-1)+bbMi.^2.*pMi.^2).*((-224)+213.* ...
    bbMi.^4.*j2+352.*bbMi.^2.*pMi.^2+(-582).*bbMi.^6.*j2.*pMi.^2+ ...
    1089.*bbMi.^8.*j2.*pMi.^4)).*rhoC+kD.*((-32)+bbMi.^2.*(3.*bbMi.* ...
    j2.*(224.*bbMi+672.*dbbMi+(-213).*bbMi.^5.*j2).*pi.^2+pMi.*(224.* ...
    pMi+3.*bbMi.^3.*j2.*pi.^2.*((-2880).*dbbMi.*pMi+795.*bbMi.^5.*j2.* ...
    pMi+2464.*bbMi.^2.*dbbMi.*pMi.^3+(-1671).*bbMi.^7.*j2.*pMi.^3+ ...
    1089.*bbMi.^9.*j2.*pMi.^5+(-576).*bbMi.*(2.*dpMi+pMi)+352.* ...
    bbMi.^3.*pMi.^2.*(4.*dpMi+pMi))))).*rhoD)+24.*j2.*(4.*((-18).* ...
    bbMi.^10.*dyMi.*j2.^2+3.*bbMi.^4.*j2.*R.*(kC.*rhoC+(-1).*kD.*rhoD) ...
    .*xMi+212.*bbMi.^2.*pMi.^2.*R.*(kC.*rhoC+(-1).*kD.*rhoD).*xMi+75.* ...
    bbMi.^8.*j2.*pMi.^4.*R.*(kC.*rhoC+(-1).*kD.*rhoD).*xMi+228.*R.*(( ...
    -1).*kC.*rhoC+kD.*rhoD).*xMi+30.*bbMi.^6.*j2.*pMi.^2.*R.*((-1).* ...
    kC.*rhoC+kD.*rhoD).*xMi+(-162).*bbMi.^9.*dbbMi.*j2.^2.*yMi+4059.* ...
    bbMi.^11.*dbbMi.*j2.^2.*pMi.^2.*yMi+(-21060).*bbMi.^13.*dbbMi.* ...
    j2.^2.*pMi.^4.*yMi+16875.*bbMi.^15.*dbbMi.*j2.^2.*pMi.^6.*yMi+ ...
    369.*bbMi.^12.*j2.^2.*pMi.*(dyMi.*pMi+2.*dpMi.*yMi)+(-1620).* ...
    bbMi.^14.*j2.^2.*pMi.^3.*(dyMi.*pMi+4.*dpMi.*yMi)+1125.*bbMi.^16.* ...
    j2.^2.*pMi.^5.*(dyMi.*pMi+6.*dpMi.*yMi)).*cos(tt)+(-1).*bbMi.^4.*( ...
    (-1)+(-6).*bbMi.^2.*pMi.^2+7.*bbMi.^4.*pMi.^4).*R.*((-1).*kC.* ...
    rhoC+kD.*rhoD).*cos(2.*tt)+(-36).*bbMi.^9.*j2.^2.*((-3).*bbMi.* ...
    dxMi+(-27).*dbbMi.*xMi+594.*bbMi.^2.*dbbMi.*pMi.^2.*xMi+(-3055).* ...
    bbMi.^4.*dbbMi.*pMi.^4.*xMi+3000.*bbMi.^6.*dbbMi.*pMi.^6.*xMi+54.* ...
    bbMi.^3.*pMi.*(dxMi.*pMi+2.*dpMi.*xMi)+(-235).*bbMi.^5.*pMi.^3.*( ...
    dxMi.*pMi+4.*dpMi.*xMi)+200.*bbMi.^7.*pMi.^5.*(dxMi.*pMi+6.*dpMi.* ...
    xMi)).*sin(tt)+4.*(252+3.*bbMi.^4.*j2+(-2).*bbMi.^2.*(134+15.* ...
    bbMi.^4.*j2).*pMi.^2+75.*bbMi.^8.*j2.*pMi.^4).*R.*((-1).*kC.*rhoC+ ...
    kD.*rhoD).*yMi.*sin(tt)))+4.*cos(tti).*(j2.*(240.*bbMi.^5.*dbbMi.* ...
    j2.*kD.*pi.^2.*R.*rhoD.*xMi+681.*bbMi.^14.*j2.^2.*pi.^2.*pMi.^4.* ...
    R.*(kC.*rhoC+(-1).*kD.*rhoD).*xMi+(-1024).*bbMi.^2.*R.*((-1).*kC.* ...
    rhoC+kD.*rhoD).*xMi+738.*bbMi.^12.*j2.^2.*pi.^2.*pMi.^2.*R.*((-1) ...
    .*kC.*rhoC+kD.*rhoD).*xMi+(-240).*bbMi.^6.*j2.*pi.^2.*R.*(dxMi.* ...
    kD.*rhoD+(-1).*kC.*rhoC.*xMi+kD.*rhoD.*xMi)+48.*bbMi.^8.*j2.*(8.* ...
    dyMi+5.*pi.^2.*pMi.*R.*(dxMi.*kD.*pMi.*rhoD+(-1).*kC.*pMi.*rhoC.* ...
    xMi+kD.*(2.*dpMi+pMi).*rhoD.*xMi))+(-5760).*bbMi.^9.*dbbMi.*j2.* ...
    pMi.^2.*yMi+160.*pi.^2.*R.^2.*((-1).*kC.*rhoC+kD.*rhoD).*(kC.* ...
    rhoC+kD.*rhoD).*yMi+48.*bbMi.^7.*dbbMi.*j2.*(5.*kD.*pi.^2.* ...
    pMi.^2.*R.*rhoD.*xMi+8.*yMi)+(-3).*bbMi.^10.*j2.*(19.*j2.*pi.^2.* ...
    R.*((-1).*kC.*rhoC+kD.*rhoD).*xMi+640.*pMi.*(dyMi.*pMi+2.*dpMi.* ...
    yMi)))+36.*bbMi.^9.*j2.^2.*R.*(24.*dbbMi.*kD.*rhoD+(-400).* ...
    bbMi.^2.*dbbMi.*kD.*pMi.^2.*rhoD+1400.*bbMi.^4.*dbbMi.*kD.* ...
    pMi.^4.*rhoD+10.*bbMi.*(kC.*rhoC+(-1).*kD.*rhoD)+815.*bbMi.^9.* ...
    j2.*pMi.^4.*(kC.*rhoC+(-1).*kD.*rhoD)+203.*bbMi.^7.*j2.*pMi.^2.*(( ...
    -1).*kC.*rhoC+kD.*rhoD)+625.*bbMi.^11.*j2.*pMi.^6.*((-1).*kC.* ...
    rhoC+kD.*rhoD)+40.*bbMi.^3.*pMi.*((-5).*kC.*pMi.*rhoC+(-4).*dpMi.* ...
    kD.*rhoD+5.*kD.*pMi.*rhoD)+bbMi.^5.*((-13).*j2.*((-1).*kC.*rhoC+ ...
    kD.*rhoD)+2.*pMi.^3.*((-9).*kC.*pMi.*rhoC+400.*dpMi.*kD.*rhoD+9.* ...
    kD.*pMi.*rhoD))).*cos(tt)+288.*bbMi.^6.*j2.^2.*((-1)+5.*bbMi.^2.* ...
    pMi.^2).*R.*((-1).*kC.*rhoC+kD.*rhoD).*xMi.*cos(2.*tt)+8.* ...
    bbMi.^10.*j2.^2.*(1+(-5).*bbMi.^2.*pMi.^2).^2.*R.*((-1).*kC.*rhoC+ ...
    kD.*rhoD).*cos(3.*tt)+(-2).*(27.*bbMi.^19.*j2.^4.*((-1)+5.* ...
    bbMi.^2.*pMi.^2).*(8.*bbMi.^3.*dpMi.*pMi.*((-1)+48.*bbMi.^2.* ...
    pMi.^2+45.*bbMi.^4.*pMi.^4)+dbbMi.*((-13)+(-125).*bbMi.^2.*pMi.^2+ ...
    1177.*bbMi.^4.*pMi.^4+945.*bbMi.^6.*pMi.^6))+512.*R.^2.*(kC.^2.* ...
    rhoC.^2+(-1).*kD.^2.*rhoD.^2)).*sin(tt)+288.*bbMi.^6.*j2.^2.*((-1) ...
    +5.*bbMi.^2.*pMi.^2).*R.*((-1).*kC.*rhoC+kD.*rhoD).*yMi.*sin(2.* ...
    tt))+32.*bbMi.*j2.*(((-640).*dbbMi.*kD.*R.*rhoD.*xMi+128.*bbMi.* ...
    R.*(dxMi.*kD.*rhoD+(-1).*kC.*rhoC.*xMi+kD.*rhoD.*xMi)+15.* ...
    bbMi.^10.*dbbMi.*j2.^2.*(12.*dyMi+(-37).*yMi)+(-48).*bbMi.^6.* ...
    dbbMi.*j2.*(dyMi+yMi)+15.*bbMi.^15.*j2.^2.*pMi.^2.*(dyMi.*(240.* ...
    dpMi+(-17).*pMi).*pMi+4.*dpMi.*(90.*dpMi+(-17).*pMi).*yMi)+(-42).* ...
    bbMi.^12.*dbbMi.*j2.^2.*pMi.*(60.*dyMi.*pMi+120.*dpMi.*yMi+(-109) ...
    .*pMi.*yMi)+135.*bbMi.^14.*dbbMi.*j2.^2.*pMi.^3.*(60.*dyMi.*pMi+ ...
    240.*dpMi.*yMi+(-17).*pMi.*yMi)+(-48).*bbMi.^7.*j2.*(dyMi+(-15).* ...
    dbbMi.^2.*pMi.^2.*yMi)+(-3).*bbMi.^11.*j2.^2.*(37.*dyMi+2520.* ...
    dbbMi.^2.*pMi.^2.*yMi)+6.*bbMi.^13.*j2.^2.*((-120).*dpMi.*dyMi.* ...
    pMi+109.*dyMi.*pMi.^2+(-60).*dpMi.^2.*yMi+218.*dpMi.*pMi.*yMi+ ...
    5400.*dbbMi.^2.*pMi.^4.*yMi)+720.*bbMi.^8.*dbbMi.*j2.*pMi.*(dyMi.* ...
    pMi+(2.*dpMi+pMi).*yMi)+120.*bbMi.^9.*j2.*(2.*dyMi.*pMi.^2+2.* ...
    dpMi.^2.*yMi+3.*dbbMi.^2.*j2.*yMi+4.*dpMi.*pMi.*(dyMi+yMi))).*cos( ...
    tt)+bbMi.^4.*((-1).*dbbMi.*kD.*R.*rhoD+bbMi.*R.*((-1).*kC.*rhoC+ ...
    kD.*rhoD)+540.*bbMi.^4.*dbbMi.*j2.^2.*pMi.^2.*xMi.*yMi+180.* ...
    bbMi.^5.*j2.^2.*pMi.*(dyMi.*pMi.*xMi+dxMi.*pMi.*yMi+2.*dpMi.*xMi.* ...
    yMi)+(-1).*bbMi.^2.*dbbMi.*(7.*kD.*pMi.^2.*R.*rhoD+36.*j2.^2.* ...
    xMi.*yMi)+(-1).*bbMi.^3.*(14.*dpMi.*kD.*pMi.*R.*rhoD+7.*pMi.^2.* ...
    R.*((-1).*kC.*rhoC+kD.*rhoD)+36.*j2.^2.*(dyMi.*xMi+dxMi.*yMi))).* ...
    cos(2.*tt)+bbMi.^10.*j2.^2.*((-1)+5.*bbMi.^2.*pMi.^2).*((-1).* ...
    bbMi.*dyMi+(-5).*dbbMi.*yMi+45.*bbMi.^2.*dbbMi.*pMi.^2.*yMi+5.* ...
    bbMi.^3.*pMi.*(dyMi.*pMi+4.*dpMi.*yMi)).*cos(3.*tt)+(-1).*(45.* ...
    bbMi.^10.*dbbMi.*j2.^2.*(4.*dxMi+(-3).*xMi)+(-48).*bbMi.^6.* ...
    dbbMi.*j2.*(dxMi+xMi)+(-210).*bbMi.^12.*dbbMi.*j2.^2.*pMi.*(12.* ...
    dxMi.*pMi+24.*dpMi.*xMi+(-1).*pMi.*xMi)+135.*bbMi.^14.*dbbMi.* ...
    j2.^2.*pMi.^3.*(60.*dxMi.*pMi+240.*dpMi.*xMi+19.*pMi.*xMi)+(-48).* ...
    bbMi.^7.*j2.*(dxMi+(-15).*dbbMi.^2.*pMi.^2.*xMi)+(-27).*bbMi.^11.* ...
    j2.^2.*(dxMi+280.*dbbMi.^2.*pMi.^2.*xMi)+720.*bbMi.^8.*dbbMi.*j2.* ...
    pMi.*(dxMi.*pMi+(2.*dpMi+pMi).*xMi)+15.*bbMi.^15.*j2.^2.*pMi.^2.*( ...
    dxMi.*pMi.*(240.*dpMi+19.*pMi)+4.*dpMi.*(90.*dpMi+19.*pMi).*xMi)+ ...
    120.*bbMi.^9.*j2.*(2.*dxMi.*pMi.^2+2.*dpMi.^2.*xMi+3.*dbbMi.^2.* ...
    j2.*xMi+4.*dpMi.*pMi.*(dxMi+xMi))+30.*bbMi.^13.*j2.^2.*((-12).* ...
    dpMi.^2.*xMi+2.*dpMi.*pMi.*((-12).*dxMi+xMi)+pMi.^2.*(dxMi+1080.* ...
    dbbMi.^2.*pMi.^2.*xMi))+640.*dbbMi.*kD.*R.*rhoD.*yMi+(-128).* ...
    bbMi.*R.*(dyMi.*kD.*rhoD+(-1).*kC.*rhoC.*yMi+kD.*rhoD.*yMi)).*sin( ...
    tt)+(-18).*bbMi.^6.*j2.^2.*(15.*bbMi.^2.*dbbMi.*pMi.^2.*(xMi+(-1) ...
    .*yMi).*(xMi+yMi)+bbMi.*((-2).*dxMi.*xMi+2.*dyMi.*yMi)+dbbMi.*(( ...
    -1).*xMi.^2+yMi.^2)+10.*bbMi.^3.*pMi.*(dxMi.*pMi.*xMi+(-1).*dyMi.* ...
    pMi.*yMi+dpMi.*(xMi+(-1).*yMi).*(xMi+yMi))).*sin(2.*tt)+(-1).* ...
    bbMi.^10.*j2.^2.*((-1)+5.*bbMi.^2.*pMi.^2).*((-1).*bbMi.*dxMi+(-5) ...
    .*dbbMi.*xMi+45.*bbMi.^2.*dbbMi.*pMi.^2.*xMi+5.*bbMi.^3.*pMi.*( ...
    dxMi.*pMi+4.*dpMi.*xMi)).*sin(3.*tt))+4.*(2.*(81.*bbMi.^19.* ...
    j2.^4.*((-1)+5.*bbMi.^2.*pMi.^2).*(8.*bbMi.^3.*dpMi.*pMi.*(25+( ...
    -128).*bbMi.^2.*pMi.^2+155.*bbMi.^4.*pMi.^4)+dbbMi.*((-91)+1045.* ...
    bbMi.^2.*pMi.^2+(-3377).*bbMi.^4.*pMi.^4+3255.*bbMi.^6.*pMi.^6))+ ...
    512.*R.^2.*(kC.^2.*rhoC.^2+(-1).*kD.^2.*rhoD.^2)).*cos(tt)+j2.*( ...
    48.*bbMi.^6.*j2.*(8.*bbMi.^2.*dxMi.*((-1)+5.*bbMi.^2.*pMi.^2)+(-5) ...
    .*dyMi.*kD.*pi.^2.*((-1)+bbMi.^2.*pMi.^2).*R.*rhoD)+32.*(12.* ...
    bbMi.^7.*j2.*(10.*bbMi.^3.*dpMi.*pMi+dbbMi.*((-1)+15.*bbMi.^2.* ...
    pMi.^2))+5.*pi.^2.*R.^2.*(kC.^2.*rhoC.^2+(-1).*kD.^2.*rhoD.^2)).* ...
    xMi+bbMi.^2.*R.*(kC.*(1024+(-3).*bbMi.^4.*j2.*pi.^2.*((-1)+ ...
    bbMi.^2.*pMi.^2).*((-80)+71.*bbMi.^4.*j2+17.*bbMi.^6.*j2.*pMi.^2)) ...
    .*rhoC+kD.*((-1024)+3.*bbMi.^3.*j2.*pi.^2.*(80.*bbMi+(-80).*dbbMi+ ...
    (-71).*bbMi.^5.*j2+(-80).*bbMi.^2.*dbbMi.*pMi.^2+54.*bbMi.^7.*j2.* ...
    pMi.^2+17.*bbMi.^9.*j2.*pMi.^4+(-80).*bbMi.^3.*pMi.*(2.*dpMi+pMi)) ...
    ).*rhoD).*yMi+4.*bbMi.^6.*j2.*R.*((-72).*((-1)+5.*bbMi.^2.*pMi.^2) ...
    .*((-1).*kC.*rhoC+kD.*rhoD).*yMi.*cos(2.*tt)+(-3).*bbMi.^3.*((-72) ...
    .*dbbMi.*kD.*rhoD+1200.*bbMi.^2.*dbbMi.*kD.*pMi.^2.*rhoD+(-4200).* ...
    bbMi.^4.*dbbMi.*kD.*pMi.^4.*rhoD+314.*bbMi.*(kC.*rhoC+(-1).*kD.* ...
    rhoD)+609.*bbMi.^7.*j2.*pMi.^2.*((-1).*kC.*rhoC+kD.*rhoD)+(-2445) ...
    .*bbMi.^9.*j2.*pMi.^4.*((-1).*kC.*rhoC+kD.*rhoD)+1875.*bbMi.^11.* ...
    j2.*pMi.^6.*((-1).*kC.*rhoC+kD.*rhoD)+16.*bbMi.^3.*pMi.*(30.* ...
    dpMi.*kD.*rhoD+97.*pMi.*((-1).*kC.*rhoC+kD.*rhoD))+bbMi.^5.*(39.* ...
    j2.*kC.*rhoC+(-3).*kD.*(13.*j2+800.*dpMi.*pMi.^3).*rhoD+(-1958).* ...
    pMi.^4.*((-1).*kC.*rhoC+kD.*rhoD))).*sin(tt)+2.*((-1)+5.*bbMi.^2.* ...
    pMi.^2).*((-1).*kC.*rhoC+kD.*rhoD).*(36.*xMi.*sin(2.*tt)+bbMi.^4.* ...
    ((-1)+5.*bbMi.^2.*pMi.^2).*sin(3.*tt))))).*sin(tti)+(-32).* ...
    bbMi.^4.*j2.*(5.*pi.^2.*((-14)+11.*bbMi.^2.*pMi.^2).*R.^2.*((-1).* ...
    kC.*rhoC+kD.*rhoD).*(kC.*rhoC+kD.*rhoD)+3.*bbMi.^2.*j2.*(3.*(3.* ...
    bbMi.^9.*j2.^2.*((-1)+5.*bbMi.^2.*pMi.^2).*(bbMi.*dxMi+9.*dbbMi.* ...
    xMi+(-76).*bbMi.^2.*dbbMi.*pMi.^2.*xMi+75.*bbMi.^4.*dbbMi.* ...
    pMi.^4.*xMi+5.*bbMi.^5.*pMi.^3.*(dxMi.*pMi+6.*dpMi.*xMi)+(-2).* ...
    bbMi.^3.*pMi.*(3.*dxMi.*pMi+11.*dpMi.*xMi))+(20+bbMi.^4.*j2+(-2).* ...
    bbMi.^2.*(18+5.*bbMi.^4.*j2).*pMi.^2+25.*bbMi.^8.*j2.*pMi.^4).*R.* ...
    ((-1).*kC.*rhoC+kD.*rhoD).*yMi).*cos(tt)+((-18).*bbMi.^10.*dyMi.* ...
    j2.^2+36.*R.*(kC.*rhoC+(-1).*kD.*rhoD).*xMi+30.*bbMi.^6.*j2.* ...
    pMi.^2.*R.*(kC.*rhoC+(-1).*kD.*rhoD).*xMi+3.*bbMi.^4.*j2.*R.*((-1) ...
    .*kC.*rhoC+kD.*rhoD).*xMi+52.*bbMi.^2.*pMi.^2.*R.*((-1).*kC.*rhoC+ ...
    kD.*rhoD).*xMi+75.*bbMi.^8.*j2.*pMi.^4.*R.*((-1).*kC.*rhoC+kD.* ...
    rhoD).*xMi+(-162).*bbMi.^9.*dbbMi.*j2.^2.*yMi+2376.*bbMi.^11.* ...
    dbbMi.*j2.^2.*pMi.^2.*yMi+(-10530).*bbMi.^13.*dbbMi.*j2.^2.* ...
    pMi.^4.*yMi+13500.*bbMi.^15.*dbbMi.*j2.^2.*pMi.^6.*yMi+216.* ...
    bbMi.^12.*j2.^2.*pMi.*(dyMi.*pMi+2.*dpMi.*yMi)+(-810).*bbMi.^14.* ...
    j2.^2.*pMi.^3.*(dyMi.*pMi+4.*dpMi.*yMi)+900.*bbMi.^16.*j2.^2.* ...
    pMi.^5.*(dyMi.*pMi+6.*dpMi.*yMi)).*sin(tt))).*sin(2.*tti)+(-4).* ...
    bbMi.^5.*j2.^2.*(2.*pi.^2.*R.*((-40).*bbMi.*dyMi.*kD.*((-1)+ ...
    bbMi.^2.*pMi.^2).*rhoD+(-1).*bbMi.*kC.*((-1)+bbMi.^2.*pMi.^2).*(( ...
    -40)+73.*bbMi.^4.*j2+46.*bbMi.^6.*j2.*pMi.^2).*rhoC.*yMi+kD.*(40.* ...
    bbMi+(-40).*dbbMi+(-73).*bbMi.^5.*j2+(-40).*bbMi.^2.*dbbMi.* ...
    pMi.^2+27.*bbMi.^7.*j2.*pMi.^2+46.*bbMi.^9.*j2.*pMi.^4+(-40).* ...
    bbMi.^3.*pMi.*(2.*dpMi+pMi)).*rhoD.*yMi)+9.*bbMi.^14.*j2.^2.*((-1) ...
    +5.*bbMi.^2.*pMi.^2).*(8.*bbMi.^3.*dpMi.*pMi.*(313+(-1408).* ...
    bbMi.^2.*pMi.^2+1255.*bbMi.^4.*pMi.^4)+dbbMi.*((-1183)+12865.* ...
    bbMi.^2.*pMi.^2+(-36757).*bbMi.^4.*pMi.^4+26355.*bbMi.^6.*pMi.^6)) ...
    .*cos(tt)+(-4).*bbMi.^5.*((-658)+(-93).*bbMi.^4.*j2+3.*bbMi.^2.*( ...
    880+521.*bbMi.^4.*j2).*pMi.^2+(-1).*bbMi.^4.*(1838+6495.*bbMi.^4.* ...
    j2).*pMi.^4+5025.*bbMi.^10.*j2.*pMi.^6).*R.*((-1).*kC.*rhoC+kD.* ...
    rhoD).*sin(tt)).*sin(3.*tti)+(-72).*bbMi.^6.*j2.^2.*((9.*bbMi.^9.* ...
    j2.^2.*((-1)+5.*bbMi.^2.*pMi.^2).*(bbMi.*dxMi+9.*dbbMi.*xMi+(-76) ...
    .*bbMi.^2.*dbbMi.*pMi.^2.*xMi+75.*bbMi.^4.*dbbMi.*pMi.^4.*xMi+5.* ...
    bbMi.^5.*pMi.^3.*(dxMi.*pMi+6.*dpMi.*xMi)+(-2).*bbMi.^3.*pMi.*(3.* ...
    dxMi.*pMi+11.*dpMi.*xMi))+32.*((-1)+bbMi.^2.*pMi.^2).*R.*((-1).* ...
    kC.*rhoC+kD.*rhoD).*yMi).*cos(tt)+(((-1)+bbMi.^2.*pMi.^2).*((-9).* ...
    bbMi.^10.*dyMi.*j2.^2.*(1+(-5).*bbMi.^2.*pMi.^2).^2+32.*R.*((-1).* ...
    kC.*rhoC+kD.*rhoD).*xMi)+(-9).*bbMi.^9.*j2.^2.*((-1)+5.*bbMi.^2.* ...
    pMi.^2).*((-22).*bbMi.^3.*dpMi.*pMi+30.*bbMi.^5.*dpMi.*pMi.^3+ ...
    dbbMi.*(9+(-76).*bbMi.^2.*pMi.^2+75.*bbMi.^4.*pMi.^4)).*yMi).*sin( ...
    tt)).*sin(4.*tti)+12.*bbMi.^10.*j2.^2.*((-1)+bbMi.^2.*pMi.^2).*( ...
    117.*bbMi.^9.*j2.^2.*((-1)+5.*bbMi.^2.*pMi.^2).*(8.*bbMi.^3.* ...
    dpMi.*pMi.*((-3)+5.*bbMi.^2.*pMi.^2)+dbbMi.*(13+(-102).*bbMi.^2.* ...
    pMi.^2+105.*bbMi.^4.*pMi.^4)).*cos(tt)+R.*((-1).*kC.*rhoC+kD.* ...
    rhoD).*(15.*j2.*pi.^2.*(1+bbMi.^2.*pMi.^2).*yMi+416.*((-1)+ ...
    bbMi.^2.*pMi.^2).*sin(tt))).*sin(5.*tti))+3.*R.^(5/2).*(tt+(-1).* ...
    tti).^2.*(2.*(640.*bbMi.^2.*dbbMi.*kD.*rhoD+(-1920).*bbMi.* ...
    dbbMi.^2.*kD.*rhoD+4480.*dbbMi.^3.*kD.*rhoD+32.*bbMi.^6.*dbbMi.* ...
    j2.*kD.*rhoD+(-32).*bbMi.^5.*dbbMi.^2.*j2.*kD.*rhoD+(-1080).* ...
    bbMi.^10.*dbbMi.*j2.^2.*kD.*rhoD+5400.*bbMi.^12.*dbbMi.*j2.^2.* ...
    kD.*pMi.^2.*rhoD+(-5040).*bbMi.^14.*dbbMi.*j2.^2.*kD.*pMi.^4.* ...
    rhoD+224.*bbMi.^8.*dbbMi.*j2.*kD.*pMi.*(2.*dpMi+pMi).*rhoD+128.* ...
    bbMi.^3.*(kC.*rhoC+(-1).*kD.*rhoD)+32.*bbMi.^7.*j2.*(kC.*rhoC+(-1) ...
    .*kD.*rhoD)+360.*bbMi.^11.*j2.^2.*(kC.*rhoC+(-1).*kD.*rhoD)+945.* ...
    bbMi.^21.*j2.^3.*pMi.^6.*(kC.*rhoC+(-1).*kD.*rhoD)+(-2277).* ...
    bbMi.^17.*j2.^3.*pMi.^2.*((-1).*kC.*rhoC+kD.*rhoD)+2556.* ...
    bbMi.^19.*j2.^3.*pMi.^4.*((-1).*kC.*rhoC+kD.*rhoD)+224.*bbMi.^9.* ...
    j2.*((-1).*kC.*pMi.^2.*rhoC+kD.*(dpMi+pMi).^2.*rhoD)+1080.* ...
    bbMi.^13.*j2.^2.*pMi.*((-1).*kC.*pMi.*rhoC+kD.*(2.*dpMi+pMi).* ...
    rhoD)+(-18).*bbMi.^15.*j2.^2.*((-37).*j2.*((-1).*kC.*rhoC+kD.* ...
    rhoD)+40.*pMi.^3.*((-1).*kC.*pMi.*rhoC+4.*dpMi.*kD.*rhoD+kD.*pMi.* ...
    rhoD)))+bbMi.*j2.*((-4).*((-240).*bbMi.^5.*dbbMi.*j2.*kD.*rhoD.* ...
    xMi+(-240).*bbMi.^7.*dbbMi.*j2.*kD.*pMi.^2.*rhoD.*xMi+738.* ...
    bbMi.^12.*j2.^2.*pMi.^2.*(kC.*rhoC+(-1).*kD.*rhoD).*xMi+57.* ...
    bbMi.^10.*j2.^2.*((-1).*kC.*rhoC+kD.*rhoD).*xMi+681.*bbMi.^14.* ...
    j2.^2.*pMi.^4.*((-1).*kC.*rhoC+kD.*rhoD).*xMi+240.*bbMi.^6.*j2.*( ...
    dxMi.*kD.*rhoD+(-1).*kC.*rhoC.*xMi+kD.*rhoD.*xMi)+(-240).* ...
    bbMi.^8.*j2.*pMi.*(dxMi.*kD.*pMi.*rhoD+(-1).*kC.*pMi.*rhoC.*xMi+ ...
    kD.*(2.*dpMi+pMi).*rhoD.*xMi)+160.*R.*(kC.^2.*rhoC.^2+(-1).* ...
    kD.^2.*rhoD.^2).*yMi).*cos(tti)+3.*bbMi.^9.*j2.*((-1).*bbMi.*kC.*( ...
    (-1)+bbMi.^2.*pMi.^2).*((-224)+213.*bbMi.^4.*j2+352.*bbMi.^2.* ...
    pMi.^2+(-582).*bbMi.^6.*j2.*pMi.^2+1089.*bbMi.^8.*j2.*pMi.^4).* ...
    rhoC+kD.*(224.*bbMi+672.*dbbMi+(-2880).*bbMi.^2.*dbbMi.*pMi.^2+ ...
    795.*bbMi.^7.*j2.*pMi.^2+2464.*bbMi.^4.*dbbMi.*pMi.^4+(-1671).* ...
    bbMi.^9.*j2.*pMi.^4+1089.*bbMi.^11.*j2.*pMi.^6+(-576).*bbMi.^3.* ...
    pMi.*(2.*dpMi+pMi)+bbMi.^5.*((-213).*j2+352.*pMi.^3.*(4.*dpMi+pMi) ...
    )).*rhoD).*cos(2.*tti)+(-8).*bbMi.^5.*j2.*((-40).*bbMi.*dxMi.*kD.* ...
    ((-1)+bbMi.^2.*pMi.^2).*rhoD+(-1).*bbMi.*kC.*((-1)+bbMi.^2.* ...
    pMi.^2).*((-40)+(-47).*bbMi.^4.*j2+76.*bbMi.^6.*j2.*pMi.^2).* ...
    rhoC.*xMi+kD.*(40.*bbMi+(-40).*dbbMi+47.*bbMi.^5.*j2+(-80).* ...
    bbMi.^3.*dpMi.*pMi+(-1).*bbMi.^2.*(40.*bbMi+40.*dbbMi+123.* ...
    bbMi.^5.*j2).*pMi.^2+76.*bbMi.^9.*j2.*pMi.^4).*rhoD.*xMi).*cos(3.* ...
    tti)+(-12).*bbMi.^9.*j2.*((-1)+bbMi.^2.*pMi.^2).*(bbMi.*kC.*(10+( ...
    -41).*bbMi.^4.*j2+2.*bbMi.^2.*((-5)+72.*bbMi.^4.*j2).*pMi.^2+(-79) ...
    .*bbMi.^8.*j2.*pMi.^4).*rhoC+kD.*((-10).*bbMi+(-30).*dbbMi+41.* ...
    bbMi.^5.*j2+40.*bbMi.^3.*dpMi.*pMi+2.*bbMi.^2.*(5.*bbMi+35.*dbbMi+ ...
    (-72).*bbMi.^5.*j2).*pMi.^2+79.*bbMi.^9.*j2.*pMi.^4).*rhoD).*cos( ...
    4.*tti)+180.*bbMi.^10.*j2.^2.*((-1)+bbMi.^4.*pMi.^4).*((-1).*kC.* ...
    rhoC+kD.*rhoD).*xMi.*cos(5.*tti)+(-15).*bbMi.^14.*j2.^2.*((-1)+ ...
    bbMi.^2.*pMi.^2).^2.*(7+5.*bbMi.^2.*pMi.^2).*((-1).*kC.*rhoC+kD.* ...
    rhoD).*cos(6.*tti)+4.*(80.*((-3).*bbMi.^6.*dyMi.*j2.*kD.*((-1)+ ...
    bbMi.^2.*pMi.^2).*rhoD+2.*R.*(kC.^2.*rhoC.^2+(-1).*kD.^2.*rhoD.^2) ...
    .*xMi)+3.*bbMi.^5.*j2.*((-1).*bbMi.*kC.*((-1)+bbMi.^2.*pMi.^2).*(( ...
    -80)+71.*bbMi.^4.*j2+17.*bbMi.^6.*j2.*pMi.^2).*rhoC+kD.*(80.*bbMi+ ...
    (-80).*dbbMi+(-71).*bbMi.^5.*j2+(-80).*bbMi.^2.*dbbMi.*pMi.^2+54.* ...
    bbMi.^7.*j2.*pMi.^2+17.*bbMi.^9.*j2.*pMi.^4+(-80).*bbMi.^3.*pMi.*( ...
    2.*dpMi+pMi)).*rhoD).*yMi).*sin(tti)+(-160).*bbMi.^4.*((-14)+11.* ...
    bbMi.^2.*pMi.^2).*R.*((-1).*kC.*rhoC+kD.*rhoD).*(kC.*rhoC+kD.* ...
    rhoD).*sin(2.*tti)+(-8).*bbMi.^5.*j2.*((-40).*bbMi.*dyMi.*kD.*(( ...
    -1)+bbMi.^2.*pMi.^2).*rhoD+(-1).*bbMi.*kC.*((-1)+bbMi.^2.*pMi.^2) ...
    .*((-40)+73.*bbMi.^4.*j2+46.*bbMi.^6.*j2.*pMi.^2).*rhoC.*yMi+kD.*( ...
    40.*bbMi+(-40).*dbbMi+(-73).*bbMi.^5.*j2+(-40).*bbMi.^2.*dbbMi.* ...
    pMi.^2+27.*bbMi.^7.*j2.*pMi.^2+46.*bbMi.^9.*j2.*pMi.^4+(-40).* ...
    bbMi.^3.*pMi.*(2.*dpMi+pMi)).*rhoD.*yMi).*sin(3.*tti)+180.* ...
    bbMi.^10.*j2.^2.*((-1)+bbMi.^4.*pMi.^4).*((-1).*kC.*rhoC+kD.*rhoD) ...
    .*yMi.*sin(5.*tti)))+4.*bbMi.*R.^(3/2).*(tt+(-1).*tti).*((-4).*( ...
    640.*bbMi.*dbbMi.^3+(-960).*dbbMi.^4+(-810).*bbMi.^11.*dbbMi.* ...
    j2.^2+678.*bbMi.^18.*dpMi.*j2.^3.*pMi+15372.*bbMi.^12.*dbbMi.^2.* ...
    j2.^2.*pMi.^2+3729.*bbMi.^17.*dbbMi.*j2.^3.*pMi.^2+(-11916).* ...
    bbMi.^20.*dpMi.*j2.^3.*pMi.^3+(-38727).*bbMi.^19.*dbbMi.*j2.^3.* ...
    pMi.^4+19170.*bbMi.^22.*dpMi.*j2.^3.*pMi.^5+47925.*bbMi.^21.* ...
    dbbMi.*j2.^3.*pMi.^6+5124.*bbMi.^13.*dbbMi.*j2.^2.*pMi.*(2.*dpMi+ ...
    pMi)+(-1572).*bbMi.^16.*dpMi.*j2.^2.*pMi.^2.*(3.*dpMi+2.*pMi)+12.* ...
    bbMi.^14.*j2.^2.*(61.*dpMi.^2+122.*dpMi.*pMi+(-2358).*dbbMi.^2.* ...
    pMi.^4)+27.*bbMi.^15.*dbbMi.*j2.^2.*(67.*j2+(-262).*pMi.^3.*(4.* ...
    dpMi+pMi))+(-96).*bbMi.^4.*j2.^2.*(dxMi.^2+2.*dxMi.*xMi+dyMi.*( ...
    dyMi+2.*yMi))+24.*bbMi.^8.*j2.*(48.*dbbMi.^2.*pMi.*(2.*dpMi+pMi)+( ...
    -1).*j2.^2.*(13.*dxMi.*xMi+31.*dyMi.*yMi))+(-192).*bbMi.^2.* ...
    dbbMi.^2.*(2+3.*j2.^2.*(xMi.^2+yMi.^2))+(-12).*bbMi.^7.*dbbMi.* ...
    j2.*(8+(-32).*dbbMi.^2.*pMi.^2+j2.^2.*(13.*xMi.^2+31.*yMi.^2))+ ...
    96.*bbMi.^3.*dbbMi.*(2+3.*j2.^2.*(2.*dxMi.*xMi+xMi.^2+yMi.*(2.* ...
    dyMi+yMi)))+12.*bbMi.^10.*j2.*(32.*dpMi.^2+3.*j2.*((-45).* ...
    dbbMi.^2+2.*j2.*pMi.^2.*(23.*dxMi.*xMi+29.*dyMi.*yMi))+2.*dpMi.* ...
    pMi.*(32+j2.^2.*(69.*xMi.^2+87.*yMi.^2)))+36.*bbMi.^9.*dbbMi.*j2.* ...
    (32.*dpMi.^2+64.*dpMi.*pMi+pMi.^2.*(32+j2.^2.*(69.*xMi.^2+87.* ...
    yMi.^2))))+bbMi.*j2.*(9.*bbMi.^10.*j2.^2.*(4.*(7.*bbMi.*dxMi+63.* ...
    dbbMi.*xMi+(-264).*bbMi.^2.*dbbMi.*pMi.^2.*xMi+221.*bbMi.^4.* ...
    dbbMi.*pMi.^4.*xMi+(-24).*bbMi.^3.*pMi.*(dxMi.*pMi+2.*dpMi.*xMi)+ ...
    17.*bbMi.^5.*pMi.^3.*(dxMi.*pMi+4.*dpMi.*xMi))+39.*bbMi.^8.*j2.*( ...
    1+(-6).*bbMi.^2.*pMi.^2+5.*bbMi.^4.*pMi.^4).*(8.*bbMi.^3.*dpMi.* ...
    pMi.*((-3)+5.*bbMi.^2.*pMi.^2)+dbbMi.*(13+(-102).*bbMi.^2.*pMi.^2+ ...
    105.*bbMi.^4.*pMi.^4)).*cos(tt)).*cos(5.*tti)+9.*bbMi.^14.*j2.^2.* ...
    (6.*bbMi.^3.*dpMi.*pMi.*(61+(-212).*bbMi.^2.*pMi.^2+163.*bbMi.^4.* ...
    pMi.^4)+dbbMi.*((-364)+2745.*bbMi.^2.*pMi.^2+(-5406).*bbMi.^4.* ...
    pMi.^4+3097.*bbMi.^6.*pMi.^6)).*cos(6.*tti)+288.*bbMi.^9.*j2.^2.*( ...
    (bbMi.*dxMi.*(1+(-5).*bbMi.^2.*pMi.^2).*(bbMi+5.*dbbMi+(-5).* ...
    bbMi.^2.*pMi.*(9.*dbbMi.*pMi+bbMi.*(4.*dpMi+pMi)))+5.*(bbMi.* ...
    dbbMi+2.*dbbMi.^2+(-2).*bbMi.^4.*dpMi.^2+(-4).*bbMi.^3.*(bbMi+7.* ...
    dbbMi).*dpMi.*pMi+2.*bbMi.^2.*((-7).*bbMi.*dbbMi+(-21).*dbbMi.^2+ ...
    15.*bbMi.^4.*dpMi.^2).*pMi.^2+20.*bbMi.^5.*(bbMi+9.*dbbMi).*dpMi.* ...
    pMi.^3+45.*bbMi.^4.*dbbMi.*(bbMi+4.*dbbMi).*pMi.^4).*xMi).*cos(tt) ...
    +(bbMi.*dyMi.*(1+(-5).*bbMi.^2.*pMi.^2).*(bbMi+5.*dbbMi+(-5).* ...
    bbMi.^2.*pMi.*(9.*dbbMi.*pMi+bbMi.*(4.*dpMi+pMi)))+5.*(bbMi.* ...
    dbbMi+2.*dbbMi.^2+(-2).*bbMi.^4.*dpMi.^2+(-4).*bbMi.^3.*(bbMi+7.* ...
    dbbMi).*dpMi.*pMi+2.*bbMi.^2.*((-7).*bbMi.*dbbMi+(-21).*dbbMi.^2+ ...
    15.*bbMi.^4.*dpMi.^2).*pMi.^2+20.*bbMi.^5.*(bbMi+9.*dbbMi).*dpMi.* ...
    pMi.^3+45.*bbMi.^4.*dbbMi.*(bbMi+4.*dbbMi).*pMi.^4).*yMi).*sin(tt) ...
    )+bbMi.^5.*j2.*cos(3.*tti).*(8.*(3.*((-40).*bbMi.*dbbMi.*dxMi+38.* ...
    bbMi.^6.*dxMi.*j2+(-80).*dbbMi.^2.*xMi+334.*bbMi.^5.*dbbMi.*j2.* ...
    xMi+168.*bbMi.^2.*dbbMi.^2.*pMi.^2.*xMi+(-975).*bbMi.^7.*dbbMi.* ...
    j2.*pMi.^2.*xMi+675.*bbMi.^9.*dbbMi.*j2.*pMi.^4.*xMi+8.*bbMi.^4.* ...
    dpMi.*(2.*dxMi.*pMi+dpMi.*xMi)+56.*bbMi.^3.*dbbMi.*pMi.*(dxMi.* ...
    pMi+2.*dpMi.*xMi)+(-93).*bbMi.^8.*j2.*pMi.*(dxMi.*pMi+2.*dpMi.* ...
    xMi)+55.*bbMi.^10.*j2.*pMi.^3.*(dxMi.*pMi+4.*dpMi.*xMi))+((-187)+ ...
    205.*bbMi.^2.*pMi.^2).*R.*((-1).*kC.*rhoC+kD.*rhoD).*yMi)+3.* ...
    bbMi.^8.*j2.*((-1)+5.*bbMi.^2.*pMi.^2).*((-3).*bbMi.^5.*j2.*(8.* ...
    bbMi.^3.*dpMi.*pMi.*(223+(-1168).*bbMi.^2.*pMi.^2+1105.*bbMi.^4.* ...
    pMi.^4)+dbbMi.*((-793)+9415.*bbMi.^2.*pMi.^2+(-30547).*bbMi.^4.* ...
    pMi.^4+23205.*bbMi.^6.*pMi.^6)).*cos(tt)+4.*(31+(-366).*bbMi.^2.* ...
    pMi.^2+335.*bbMi.^4.*pMi.^4).*R.*((-1).*kC.*rhoC+kD.*rhoD).*sin( ...
    tt)))+6.*cos(tti).*(2.*((-240).*bbMi.^6.*dbbMi.*dxMi.*j2+75.* ...
    bbMi.^11.*dxMi.*j2.^2+32.*bbMi.*dyMi.*kD.*R.*rhoD+819.*bbMi.^10.* ...
    dbbMi.*j2.^2.*xMi+126.*bbMi.^12.*dbbMi.*j2.^2.*pMi.^2.*xMi+(-1425) ...
    .*bbMi.^14.*dbbMi.*j2.^2.*pMi.^4.*xMi+48.*bbMi.^9.*dpMi.*j2.*(2.* ...
    dxMi.*pMi+dpMi.*xMi)+336.*bbMi.^8.*dbbMi.*j2.*pMi.*(dxMi.*pMi+2.* ...
    dpMi.*xMi)+90.*bbMi.^13.*j2.^2.*pMi.*(dxMi.*pMi+2.*dpMi.*xMi)+( ...
    -165).*bbMi.^15.*j2.^2.*pMi.^3.*(dxMi.*pMi+4.*dpMi.*xMi)+(-32).* ...
    dbbMi.*kD.*R.*rhoD.*yMi+(-8).*bbMi.^5.*j2.*(60.*dbbMi.^2.*xMi+7.* ...
    R.*(kC.*rhoC+(-1).*kD.*rhoD).*yMi)+12.*bbMi.^7.*j2.*pMi.^2.*(84.* ...
    dbbMi.^2.*xMi+41.*R.*(kC.*rhoC+(-1).*kD.*rhoD).*yMi))+(-3).* ...
    bbMi.^8.*j2.*(1+(-5).*bbMi.^2.*pMi.^2).*(3.*bbMi.^10.*j2.^2.*(8.* ...
    bbMi.^3.*dpMi.*pMi.*((-1)+48.*bbMi.^2.*pMi.^2+45.*bbMi.^4.*pMi.^4) ...
    +dbbMi.*((-13)+(-125).*bbMi.^2.*pMi.^2+1177.*bbMi.^4.*pMi.^4+945.* ...
    bbMi.^6.*pMi.^6)).*cos(tt)+2.*R.*((-24).*dbbMi.*kD.*rhoD+280.* ...
    bbMi.^2.*dbbMi.*kD.*pMi.^2.*rhoD+bbMi.*(8.*kC.*rhoC+(-8).*kD.* ...
    rhoD)+138.*bbMi.^7.*j2.*pMi.^2.*(kC.*rhoC+(-1).*kD.*rhoD)+13.* ...
    bbMi.^5.*j2.*((-1).*kC.*rhoC+kD.*rhoD)+125.*bbMi.^9.*j2.*pMi.^4.*( ...
    (-1).*kC.*rhoC+kD.*rhoD)+40.*bbMi.^3.*pMi.*((-1).*kC.*pMi.*rhoC+ ...
    kD.*(4.*dpMi+pMi).*rhoD)).*sin(tt)))+3.*bbMi.*cos(2.*tti).*(3.* ...
    bbMi.^3.*(320.*dbbMi.^3.*((-2)+7.*bbMi.^2.*pMi.^2)+96.*dbbMi.^2.*( ...
    18.*bbMi.^5.*j2+28.*bbMi.^3.*dpMi.*pMi+(-55).*bbMi.^7.*j2.*pMi.^2+ ...
    39.*bbMi.^9.*j2.*pMi.^4)+6.*bbMi.^9.*dpMi.*j2.*(16.*dpMi.*((-1)+ ...
    3.*bbMi.^2.*pMi.^2)+bbMi.^4.*j2.*pMi.*((-7)+(-176).*bbMi.^2.* ...
    pMi.^2+243.*bbMi.^4.*pMi.^4))+bbMi.^4.*dbbMi.*(448.*dpMi.^2+192.* ...
    bbMi.^4.*dpMi.*j2.*pMi.*((-11)+13.*bbMi.^2.*pMi.^2)+3.*bbMi.^6.* ...
    j2.^2.*(182+(-105).*bbMi.^2.*pMi.^2+(-1496).*bbMi.^4.*pMi.^4+ ...
    1539.*bbMi.^6.*pMi.^6)))+(-128).*j2.*R.*((-1).*kC.*rhoC+kD.*rhoD) ...
    .*xMi.*yMi+24.*bbMi.^8.*j2.^2.*((3.*bbMi.^5.*j2.*((-3).*bbMi.* ...
    dxMi+(-27).*dbbMi.*xMi+594.*bbMi.^2.*dbbMi.*pMi.^2.*xMi+(-3055).* ...
    bbMi.^4.*dbbMi.*pMi.^4.*xMi+3000.*bbMi.^6.*dbbMi.*pMi.^6.*xMi+54.* ...
    bbMi.^3.*pMi.*(dxMi.*pMi+2.*dpMi.*xMi)+(-235).*bbMi.^5.*pMi.^3.*( ...
    dxMi.*pMi+4.*dpMi.*xMi)+200.*bbMi.^7.*pMi.^5.*(dxMi.*pMi+6.*dpMi.* ...
    xMi))+(-1).*(1+(-5).*bbMi.^2.*pMi.^2).^2.*R.*((-1).*kC.*rhoC+kD.* ...
    rhoD).*yMi).*cos(tt)+(((-1)+5.*bbMi.^2.*pMi.^2).*(3.*bbMi.^6.* ...
    dyMi.*j2.*(2+(-31).*bbMi.^2.*pMi.^2+25.*bbMi.^4.*pMi.^4)+(-1).*(( ...
    -1)+5.*bbMi.^2.*pMi.^2).*R.*((-1).*kC.*rhoC+kD.*rhoD).*xMi)+3.* ...
    bbMi.^5.*j2.*(2.*bbMi.^3.*dpMi.*pMi.*(41+(-360).*bbMi.^2.*pMi.^2+ ...
    375.*bbMi.^4.*pMi.^4)+dbbMi.*((-18)+451.*bbMi.^2.*pMi.^2+(-2340).* ...
    bbMi.^4.*pMi.^4+1875.*bbMi.^6.*pMi.^6)).*yMi).*sin(tt)))+18.* ...
    bbMi.^9.*j2.*cos(4.*tti).*(720.*dbbMi.^2+(-64).*bbMi.^4.*dpMi.^2+( ...
    -377).*bbMi.^5.*dbbMi.*j2+4.*bbMi.^3.*dpMi.*((-352).*dbbMi+37.* ...
    bbMi.^5.*j2).*pMi+2.*bbMi.^2.*((-1760).*dbbMi.^2+132.*bbMi.^4.* ...
    dpMi.^2+555.*bbMi.^5.*dbbMi.*j2).*pMi.^2+4.*bbMi.^5.*dpMi.*(572.* ...
    dbbMi+(-61).*bbMi.^5.*j2).*pMi.^3+bbMi.^4.*dbbMi.*(3432.*dbbMi+( ...
    -1037).*bbMi.^5.*j2).*pMi.^4+96.*bbMi.^12.*dpMi.*j2.*pMi.^5+304.* ...
    bbMi.^11.*dbbMi.*j2.*pMi.^6+9.*bbMi.^5.*j2.^2.*(1+(-5).*bbMi.^2.* ...
    pMi.^2).*((bbMi.*dxMi+9.*dbbMi.*xMi+(-76).*bbMi.^2.*dbbMi.* ...
    pMi.^2.*xMi+75.*bbMi.^4.*dbbMi.*pMi.^4.*xMi+5.*bbMi.^5.*pMi.^3.*( ...
    dxMi.*pMi+6.*dpMi.*xMi)+(-2).*bbMi.^3.*pMi.*(3.*dxMi.*pMi+11.* ...
    dpMi.*xMi)).*cos(tt)+(-1).*(bbMi.*dyMi+9.*dbbMi.*yMi+(-76).* ...
    bbMi.^2.*dbbMi.*pMi.^2.*yMi+75.*bbMi.^4.*dbbMi.*pMi.^4.*yMi+5.* ...
    bbMi.^5.*pMi.^3.*(dyMi.*pMi+6.*dpMi.*yMi)+(-2).*bbMi.^3.*pMi.*(3.* ...
    dyMi.*pMi+11.*dpMi.*yMi)).*sin(tt)))+6.*(480.*bbMi.^6.*dbbMi.* ...
    dyMi.*j2+222.*bbMi.^11.*dyMi.*j2.^2+(-64).*bbMi.*dxMi.*kD.*R.* ...
    rhoD+64.*dbbMi.*kD.*R.*rhoD.*xMi+1710.*bbMi.^10.*dbbMi.*j2.^2.* ...
    yMi+(-8964).*bbMi.^12.*dbbMi.*j2.^2.*pMi.^2.*yMi+8310.*bbMi.^14.* ...
    dbbMi.*j2.^2.*pMi.^4.*yMi+8.*bbMi.^7.*j2.*pMi.^2.*(167.*R.*((-1).* ...
    kC.*rhoC+kD.*rhoD).*xMi+(-252).*dbbMi.^2.*yMi)+(-64).*bbMi.^5.* ...
    j2.*((-8).*kC.*R.*rhoC.*xMi+8.*kD.*R.*rhoD.*xMi+(-15).*dbbMi.^2.* ...
    yMi)+(-96).*bbMi.^9.*dpMi.*j2.*(2.*dyMi.*pMi+dpMi.*yMi)+(-672).* ...
    bbMi.^8.*dbbMi.*j2.*pMi.*(dyMi.*pMi+2.*dpMi.*yMi)+(-972).* ...
    bbMi.^13.*j2.^2.*pMi.*(dyMi.*pMi+2.*dpMi.*yMi)+750.*bbMi.^15.* ...
    j2.^2.*pMi.^3.*(dyMi.*pMi+4.*dpMi.*yMi)+(-3).*bbMi.^8.*j2.*(1+(-5) ...
    .*bbMi.^2.*pMi.^2).*(2.*R.*(bbMi.*kC.*((-8)+(-13).*bbMi.^4.*j2+2.* ...
    bbMi.^2.*(20+69.*bbMi.^4.*j2).*pMi.^2+(-125).*bbMi.^8.*j2.*pMi.^4) ...
    .*rhoC+kD.*(8.*bbMi+24.*dbbMi+13.*bbMi.^5.*j2+(-160).*bbMi.^3.* ...
    dpMi.*pMi+(-2).*bbMi.^2.*(20.*bbMi+140.*dbbMi+69.*bbMi.^5.*j2).* ...
    pMi.^2+125.*bbMi.^9.*j2.*pMi.^4).*rhoD).*cos(tt)+9.*bbMi.^10.* ...
    j2.^2.*(8.*bbMi.^3.*dpMi.*pMi.*(25+(-128).*bbMi.^2.*pMi.^2+155.* ...
    bbMi.^4.*pMi.^4)+dbbMi.*((-91)+1045.*bbMi.^2.*pMi.^2+(-3377).* ...
    bbMi.^4.*pMi.^4+3255.*bbMi.^6.*pMi.^6)).*sin(tt))).*sin(tti)+(-24) ...
    .*bbMi.*(2.*R.*((-99).*bbMi.^3.*dbbMi.*kD.*rhoD+95.*bbMi.^5.* ...
    dbbMi.*kD.*pMi.^2.*rhoD+18.*bbMi.^8.*j2.*(kC.*rhoC+(-1).*kD.*rhoD) ...
    +156.*bbMi.^12.*j2.*pMi.^4.*(kC.*rhoC+(-1).*kD.*rhoD)+15.* ...
    bbMi.^4.*((-1).*kC.*rhoC+kD.*rhoD)+183.*bbMi.^10.*j2.*pMi.^2.*(( ...
    -1).*kC.*rhoC+kD.*rhoD)+bbMi.^6.*pMi.*(14.*dpMi.*kD.*rhoD+15.* ...
    pMi.*(kC.*rhoC+(-1).*kD.*rhoD))+(-4).*j2.*((-1).*kC.*rhoC+kD.* ...
    rhoD).*(xMi+(-1).*yMi).*(xMi+yMi))+3.*bbMi.^8.*j2.^2.*((-1)+5.* ...
    bbMi.^2.*pMi.^2).*((-1).*(((-1)+5.*bbMi.^2.*pMi.^2).*(6.*bbMi.^6.* ...
    dyMi.*j2.*((-1)+2.*bbMi.^2.*pMi.^2)+R.*((-1).*kC.*rhoC+kD.*rhoD).* ...
    xMi)+18.*bbMi.^5.*j2.*(4.*bbMi.^3.*dpMi.*pMi.*((-2)+5.*bbMi.^2.* ...
    pMi.^2)+dbbMi.*(3+(-29).*bbMi.^2.*pMi.^2+50.*bbMi.^4.*pMi.^4)).* ...
    yMi).*cos(tt)+(3.*bbMi.^5.*j2.*(bbMi.*dxMi+9.*dbbMi.*xMi+(-76).* ...
    bbMi.^2.*dbbMi.*pMi.^2.*xMi+75.*bbMi.^4.*dbbMi.*pMi.^4.*xMi+5.* ...
    bbMi.^5.*pMi.^3.*(dxMi.*pMi+6.*dpMi.*xMi)+(-2).*bbMi.^3.*pMi.*(3.* ...
    dxMi.*pMi+11.*dpMi.*xMi))+((-1)+5.*bbMi.^2.*pMi.^2).*R.*((-1).* ...
    kC.*rhoC+kD.*rhoD).*yMi).*sin(tt))).*sin(2.*tti)+bbMi.^5.*j2.*(8.* ...
    ((-120).*bbMi.*dbbMi.*dyMi+(-84).*bbMi.^6.*dyMi.*j2+187.*R.*((-1) ...
    .*kC.*rhoC+kD.*rhoD).*xMi+(-240).*dbbMi.^2.*yMi+(-780).*bbMi.^5.* ...
    dbbMi.*j2.*yMi+3213.*bbMi.^7.*dbbMi.*j2.*pMi.^2.*yMi+(-2655).* ...
    bbMi.^9.*dbbMi.*j2.*pMi.^4.*yMi+bbMi.^2.*pMi.^2.*(205.*R.*(kC.* ...
    rhoC+(-1).*kD.*rhoD).*xMi+504.*dbbMi.^2.*yMi)+24.*bbMi.^4.*dpMi.*( ...
    2.*dyMi.*pMi+dpMi.*yMi)+168.*bbMi.^3.*dbbMi.*pMi.*(dyMi.*pMi+2.* ...
    dpMi.*yMi)+279.*bbMi.^8.*j2.*pMi.*(dyMi.*pMi+2.*dpMi.*yMi)+(-195) ...
    .*bbMi.^10.*j2.*pMi.^3.*(dyMi.*pMi+4.*dpMi.*yMi))+3.*bbMi.^8.*j2.* ...
    ((-1)+5.*bbMi.^2.*pMi.^2).*((-4).*(31+(-366).*bbMi.^2.*pMi.^2+ ...
    335.*bbMi.^4.*pMi.^4).*R.*((-1).*kC.*rhoC+kD.*rhoD).*cos(tt)+(-3) ...
    .*bbMi.^5.*j2.*(8.*bbMi.^3.*dpMi.*pMi.*(313+(-1408).*bbMi.^2.* ...
    pMi.^2+1255.*bbMi.^4.*pMi.^4)+dbbMi.*((-1183)+12865.*bbMi.^2.* ...
    pMi.^2+(-36757).*bbMi.^4.*pMi.^4+26355.*bbMi.^6.*pMi.^6)).*sin(tt) ...
    )).*sin(3.*tti)+(-18).*bbMi.^9.*j2.*((151+(-346).*bbMi.^2.*pMi.^2+ ...
    195.*bbMi.^4.*pMi.^4).*R.*((-1).*kC.*rhoC+kD.*rhoD)+9.*bbMi.^5.* ...
    j2.^2.*((-1)+5.*bbMi.^2.*pMi.^2).*((bbMi.*dyMi+9.*dbbMi.*yMi+(-76) ...
    .*bbMi.^2.*dbbMi.*pMi.^2.*yMi+75.*bbMi.^4.*dbbMi.*pMi.^4.*yMi+5.* ...
    bbMi.^5.*pMi.^3.*(dyMi.*pMi+6.*dpMi.*yMi)+(-2).*bbMi.^3.*pMi.*(3.* ...
    dyMi.*pMi+11.*dpMi.*yMi)).*cos(tt)+(bbMi.*dxMi+9.*dbbMi.*xMi+(-76) ...
    .*bbMi.^2.*dbbMi.*pMi.^2.*xMi+75.*bbMi.^4.*dbbMi.*pMi.^4.*xMi+5.* ...
    bbMi.^5.*pMi.^3.*(dxMi.*pMi+6.*dpMi.*xMi)+(-2).*bbMi.^3.*pMi.*(3.* ...
    dxMi.*pMi+11.*dpMi.*xMi)).*sin(tt))).*sin(4.*tti)+9.*bbMi.^10.* ...
    j2.^2.*(4.*(7.*bbMi.*dyMi+63.*dbbMi.*yMi+(-264).*bbMi.^2.*dbbMi.* ...
    pMi.^2.*yMi+221.*bbMi.^4.*dbbMi.*pMi.^4.*yMi+(-24).*bbMi.^3.*pMi.* ...
    (dyMi.*pMi+2.*dpMi.*yMi)+17.*bbMi.^5.*pMi.^3.*(dyMi.*pMi+4.*dpMi.* ...
    yMi))+39.*bbMi.^8.*j2.*(1+(-6).*bbMi.^2.*pMi.^2+5.*bbMi.^4.* ...
    pMi.^4).*(8.*bbMi.^3.*dpMi.*pMi.*((-3)+5.*bbMi.^2.*pMi.^2)+dbbMi.* ...
    (13+(-102).*bbMi.^2.*pMi.^2+105.*bbMi.^4.*pMi.^4)).*sin(tt)).*sin( ...
    5.*tti))));

  % Concatenate the elements of the final relative state
  meanRelativeState = [dbb; dx; dy; dp; doo; dt];

end

